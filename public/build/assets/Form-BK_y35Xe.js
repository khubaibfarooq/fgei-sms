import{r as S,j as e,L as C,$ as N,S as d}from"./app-D2yfe91A.js";import{A as y,a as g,d as b}from"./app-layout-TbNRwi80.js";import{B as p}from"./button-D8cKjy96.js";import{C as k,a as q,b as F,c as L}from"./card-D_0ugHV_.js";import{I as m}from"./input-C5lyt2TR.js";import{L as n}from"./label-DEn8bx0C.js";import{T as A}from"./textarea-B8wwOV0X.js";import{C as c}from"./checkbox-xYaMH0oc.js";import{S as E,a as I,b as w,c as D,d as h}from"./select-C2o5Xs3e.js";import{t as x}from"./index-CWWH-7J6.js";import{M as T}from"./MultiSelect-DGKAvUV0.js";import"./index-DMAbBzle.js";import"./createLucideIcon-zfdp9wgf.js";import"./index-D034NJxB.js";import"./index-CmmfoCgt.js";import"./index-I2D0tqza.js";import"./index-ErdJwvbp.js";import"./app-logo-icon-DFNUwCLV.js";import"./circle-x-BPoZhuA6.js";import"./clsx-B-dksMZM.js";import"./folder-root-CS05cmH6.js";import"./grip-vertical-BUDcUNgI.js";import"./index-BPUFfsnf.js";import"./index-qHeioy_k.js";function ce({stage:s,fundHeads:u,users:_}){var t,o;const l=!!s,[a,i]=S.useState({stage_name:(s==null?void 0:s.stage_name)||"",fund_head_id:((t=s==null?void 0:s.fund_head_id)==null?void 0:t.toString())||"",stage_order:((o=s==null?void 0:s.stage_order)==null?void 0:o.toString())||"",description:(s==null?void 0:s.description)||"",is_mandatory:(s==null?void 0:s.is_mandatory)??!0,users_can_approve:(s==null?void 0:s.users_can_approve)||[],is_last:(s==null?void 0:s.is_last)??!1,level:(s==null?void 0:s.level)||"",is_user_required:(s==null?void 0:s.is_user_required)??!1,change_to_in_progress:(s==null?void 0:s.change_to_in_progress)??!1,can_change_cost:(s==null?void 0:s.can_change_cost)??!1}),j=r=>{r.preventDefault(),l?d.put(`/approval-stages/${s.id}`,a,{onSuccess:()=>x.success("Stage updated successfully")}):d.post("/approval-stages",a,{onSuccess:()=>x.success("Stage created successfully")})},v=[{title:"Approval Stages",href:"/approval-stages"},{title:l?"Edit Stage":"Create Stage",href:"#"}];return e.jsxs(y,{breadcrumbs:v,children:[e.jsx(C,{title:l?"Edit Stage":"Create Stage"}),e.jsx("div",{className:"flex-1 p-4 md:p-6 w-full mx-auto",children:e.jsxs(k,{children:[e.jsx(q,{children:e.jsx(F,{children:l?"Edit Approval Stage":"Define New Stage"})}),e.jsx(L,{children:e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:["Stage Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{value:a.stage_name,onChange:r=>i({...a,stage_name:r.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Fund Head (Categorical)"}),e.jsxs(E,{value:a.fund_head_id,onValueChange:r=>i({...a,fund_head_id:r}),children:[e.jsx(I,{children:e.jsx(w,{placeholder:"Select Fund Head (Optional)"})}),e.jsxs(D,{children:[e.jsx(h,{value:"0",children:"Global (No specific Fund Head)"}),u.map(r=>e.jsx(h,{value:r.id.toString(),children:r.name},r.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(n,{children:["Stage Order (Sequence) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{type:"number",value:a.stage_order,onChange:r=>i({...a,stage_order:r.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Description"}),e.jsx(A,{value:a.description,onChange:r=>i({...a,description:r.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"mandatory",checked:a.is_mandatory,onCheckedChange:r=>i({...a,is_mandatory:!!r})}),e.jsx(n,{htmlFor:"mandatory",children:"Mandatory Stage?"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"is_user_required",checked:a.is_user_required,onCheckedChange:r=>i({...a,is_user_required:!!r})}),e.jsx(n,{htmlFor:"is_user_required",children:"User Selection Req?"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"is_last",checked:a.is_last,onCheckedChange:r=>i({...a,is_last:!!r})}),e.jsx(n,{htmlFor:"is_last",children:"Is Last Stage?"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"change_to_in_progress",checked:a.change_to_in_progress,onCheckedChange:r=>i({...a,change_to_in_progress:!!r})}),e.jsx(n,{htmlFor:"change_to_in_progress",children:"Change to In Progress?"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(c,{id:"can_change_cost",checked:a.can_change_cost,onCheckedChange:r=>i({...a,can_change_cost:!!r})}),e.jsx(n,{htmlFor:"can_change_cost",children:"Can Change Cost?"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{children:"Approvers (Users)"}),e.jsx(T,{options:_.map(r=>({value:r.id.toString(),label:r.name})),value:(a.users_can_approve||[]).map(r=>r.toString()),onChange:r=>i({...a,users_can_approve:r.map(f=>parseInt(f))}),placeholder:"Select Approvers..."})]}),e.jsx("div",{className:"flex items-center space-x-2"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{children:"Level"}),e.jsxs("select",{value:a.level,onChange:r=>i({...a,level:r.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Level"}),e.jsx("option",{value:"institutional",children:"Institutional"}),e.jsx("option",{value:"regional",children:"Regional"}),e.jsx("option",{value:"dte",children:"DTE"})]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(N,{href:"/approval-stages",children:e.jsxs(p,{variant:"outline",type:"button",children:[e.jsx(g,{className:"w-4 h-4 mr-2"})," Back"]})}),e.jsxs(p,{type:"submit",children:[e.jsx(b,{className:"w-4 h-4 mr-2"})," Save Stage"]})]})]})})]})})]})}export{ce as default};
