import{K as _,r as c,j as e,L as E,S as f,a as C}from"./app-CdBtRg6D.js";import{A as H}from"./app-layout-6YK6TtMl.js";import{C as y,c as S,a as U,b as B}from"./card-DRdffkAX.js";import{D as P,a as R,b as V,c as W,d as X,t as q}from"./index-CeHTobFS.js";import{C as z,a as D}from"./circle-x-DAouILXE.js";import"./button-4tCdO6tP.js";import"./index-DTpmm5Rc.js";import"./createLucideIcon-C2j3twW2.js";import"./index-Ca3pCYDs.js";import"./index-BTUUu0h3.js";import"./index-M6Cr-8GG.js";import"./index-Tu85Cv4Y.js";import"./input-mlFze9Nq.js";import"./app-logo-icon-KzpG920t.js";import"./folder-root-kRweJTW5.js";import"./grip-vertical-DOg6W4W3.js";const G=[{title:"Dashboard",href:"/dashboard"}],L=[{label:"Users",value:420,color:"#3b82f6",redirectlink:""},{label:"Backups",value:80,color:"#10b981",redirectlink:""},{label:"Activity Logs",value:1570,color:"#f59e0b",redirectlink:""}],$=[{bg:"from-blue-50 to-blue-100",border:"border-blue-200",header:"bg-blue-500",text:"text-blue-800",accent:"bg-blue-200/50"},{bg:"from-green-50 to-green-100",border:"border-green-200",header:"bg-green-500",text:"text-green-800",accent:"bg-green-200/50"},{bg:"from-amber-50 to-amber-100",border:"border-amber-200",header:"bg-amber-500",text:"text-amber-800",accent:"bg-amber-200/50"}],J=r=>r.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),j=r=>!r||r.length===0?[]:Object.keys(r[0]),Q=(r,o,u,b)=>{if(r==null)return"-";const x=["balance","cost","amount","price","value","total_cost","total_amount","estimated_cost","actual_cost"].some(d=>o==null?void 0:o.toLowerCase().includes(d));if(typeof r=="number")return x&&r>=1e6?`${(r/1e6).toFixed(2)} Mn`:r.toLocaleString();if(typeof r=="string"){if(x){const d=parseFloat(r);if(!isNaN(d))return d>=1e6?`${(d/1e6).toFixed(2)} Mn`:`${d.toLocaleString()}`}return u===1&&b!=="Funds"?r.charAt(0).toUpperCase()+r.slice(1).toLowerCase():r}return String(r)};function ue(){const{props:r}=_();r.auth.user;const o=r.cards||[],[u,b]=c.useState(L),[g,x]=c.useState(!1),[d,Y]=c.useState({}),[h,N]=c.useState({0:5,1:5,2:5}),[F,p]=c.useState(!1),[i,k]=c.useState(null),[M,w]=c.useState(!1),T=async(t,s)=>{if(t&&t.includes("/dashboard/completion")){w(!0),p(!0),k(null);try{const a=await C.get(t);k(a.data)}catch(a){console.error(a),q.error("Failed to load details"),p(!1)}finally{w(!1)}}else t&&f.visit(t)},A=[{title:r.title1||"Funds",data:r.tab1||[],columns:j(r.tab1||[]),link:r.link1||""},{title:r.title2||"Tab2",data:r.tab2||[],columns:j(r.tab2||[]),link:r.link2||""},{title:r.title3||"Tab3",data:r.tab3||[],columns:j(r.tab3||[]),link:r.link3||""}];c.useEffect(()=>{if(o.length===0)return;(async()=>{x(!0);try{const s=o.map(async l=>{try{const n=await C.get(l.link);return{label:l.title,value:n.data.count||0,color:l.color,redirectlink:l.redirectlink}}catch(n){return console.error(`Failed to fetch count for ${l.title}:`,n),{label:l.title,value:0,color:l.color,redirectlink:l.redirectlink}}}),a=await Promise.all(s);b(a)}catch(s){console.error("Failed to fetch summary data:",s)}finally{x(!1)}})()},[o]);const K=t=>{N(s=>({...s,[t]:(s[t]||5)+5}))},O=t=>{N(s=>({...s,[t]:Math.max(5,(s[t]||5)-5)}))};return e.jsxs(H,{breadcrumbs:G,children:[e.jsx(E,{title:"Dashboard"}),e.jsxs("div",{className:"flex flex-col gap-6 p-5",children:[e.jsx("div",{className:"relative px-8 py-6 text-center",children:e.jsx(y,{className:"inline-block bg-primary/95 backdrop-blur-sm shadow-2xl border-0 max-w-3xl mx-auto mb-2 p-5",style:{borderBottom:"6px solid rgba(0,0,255,0.7)"},children:e.jsx(S,{className:"pt-5 px-10",children:e.jsx("h1",{className:"text-2xl md:text-4xl font-bold text-white",children:"School Management System"})})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:(g?L:u).map((t,s)=>{var n;const a=o[s],l=(a==null?void 0:a.icon)||["Users","HardDrive","LogIcon"][s%3];return e.jsx("div",{onClick:()=>{var m;(m=t.redirectlink)!=null&&m.includes("/dashboard/completion")?T(t.redirectlink):t.redirectlink&&f.visit(t.redirectlink)},className:t.redirectlink?"cursor-pointer":"",children:e.jsx(y,{redirectLink:(n=t.redirectlink)!=null&&n.includes("/dashboard/completion")?void 0:t.redirectlink,number:g?"...":t.label==="Funds"||t.label==="Institutes Funds"?`${(t.value/1e6).toFixed(2)}Mn`:t.value,title:t.label,icon:l,iconBgColor:t.color,changeColorOnHover:!0,className:"shadow-lg p-5 hover:scale-110 hover:-translate-y-2 transition-all duration-300 ease-in-out active:scale-95"})},s)})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:A.map((t,s)=>{const a=$[s%$.length];return e.jsxs(y,{className:`bg-gradient-to-br ${a.bg} ${a.border} shadow-lg rounded-xl overflow-hidden dark:bg-gray-800 dark:border-gray-700`,children:[e.jsx(U,{className:`${a.header} text-white px-6 py-4 dark:bg-gray-700`,children:e.jsxs(B,{className:"text-lg font-semibold flex items-center",children:[e.jsx("span",{className:"w-3 h-3 bg-white rounded-full mr-2"}),t.title]})}),e.jsx(S,{className:"p-0",children:t.data.length>0?e.jsxs("div",{className:"overflow-x-auto px-4 py-3",children:[e.jsx("div",{className:"shadow-sm rounded-md overflow-hidden",children:e.jsxs("table",{className:"w-full table-fixed",children:[e.jsx("thead",{className:`${a.accent} dark:bg-gray-600`,children:e.jsx("tr",{children:t.columns.map((l,n)=>l!=="Key"&&e.jsx("th",{className:"text-left py-3 px-4 text-sm md:text-lg font-medium dark:text-gray-200",style:{color:a.header.replace("bg-","text-")+"900"},children:J(l)},n))})}),e.jsx("tbody",{children:t.data.slice(0,h[s]||5).map((l,n)=>e.jsx("tr",{onClick:()=>{l.Key&&t.link&&f.visit(`${t.link}${l.Key}`)},className:`border-b ${t.link?"cursor-pointer":""} ${a.border}/30 transition-all hover:opacity-95 hover:shadow-md
                          ${n%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700"}`,children:t.columns.map((m,v)=>m!=="Key"&&e.jsx("td",{className:`py-3 px-4 text-sm md:text-lg ${a.text}`,children:Q(l[m],m,v,t.title)},v))},n))})]})}),t.data.length>5&&e.jsxs("div",{className:"p-4 text-center border-t border-gray-200 bg-gray-50 flex gap-2 justify-center",children:[(h[s]||5)<t.data.length&&e.jsxs("button",{type:"button",onClick:()=>K(s),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border border-transparent bg-blue-500 text-white shadow-sm hover:bg-blue-600 focus:outline-none transition-colors",children:["Show More (",t.data.length-(h[s]||5)," remaining)"]}),(h[s]||5)>5&&e.jsx("button",{type:"button",onClick:()=>O(s),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border border-transparent bg-gray-400 text-white shadow-sm hover:bg-gray-500 focus:outline-none transition-colors",children:"Show Less"})]})]}):e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"No data available"})})]},s)})}),e.jsx(P,{open:F,onOpenChange:p,children:e.jsxs(R,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(V,{children:[e.jsxs(W,{className:"text-xl",children:["Completion Details: ",(i==null?void 0:i.institute)||"Loading..."]}),e.jsx(X,{children:"Detailed breakdown of invalid or missing criteria."})]}),M?e.jsx("div",{className:"flex justify-center p-8",children:"Loading details..."}):i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-semibold text-lg",children:"Total Score"}),e.jsxs("span",{className:`text-2xl font-bold ${i.percentage===100?"text-green-600":i.percentage<50?"text-red-600":"text-yellow-600"}`,children:[i.percentage,"%"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-muted-foreground uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Criteria"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Weight"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Message"})]})}),e.jsx("tbody",{className:"divide-y",children:i.criteria.map((t,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:t.name}),e.jsxs("td",{className:"px-4 py-3 text-right text-muted-foreground",children:[t.weight,"%"]}),e.jsx("td",{className:"px-4 py-3 text-center",children:t.completed?e.jsx(z,{className:"w-5 h-5 text-green-500 mx-auto"}):e.jsx(D,{className:"w-5 h-5 text-red-500 mx-auto"})}),e.jsx("td",{className:`px-4 py-3 ${t.completed?"text-green-600":"text-red-600"}`,children:t.message})]},s))})]})}),i.percentage<100&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-blue-50 p-3 rounded border border-blue-100 dark:bg-blue-900/20 dark:border-blue-900",children:["Note: Please address the items marked with ",e.jsx(D,{className:"w-3 h-3 inline text-red-500"})," to reach 100% completion."]})]}):e.jsx("div",{className:"text-center text-red-500",children:"Failed to load details."})]})})]})]})}export{ue as default};
