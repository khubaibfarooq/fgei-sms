import{r as d,j as e,L as C,$ as j,S as c}from"./app-vtWODLh2.js";import{A as k,f as S,P as D,S as I,e as T,T as E}from"./app-layout-RymwaGO0.js";import{B as l}from"./button-CWU0XCXQ.js";import{C as F,a as L,b as P,c as $}from"./card-3F4pMAmN.js";import{I as R}from"./input-FQ_x3YO0.js";import{A as _,a as z,b as H,c as K,d as M,e as q,f as B,g as O,h as U}from"./alert-dialog-Cdzmqf92.js";import{t as r}from"./index-Bf5Dxd9Y.js";import{L as X}from"./app-logo-icon-BKfON3VF.js";import"./index-CYtvQJCM.js";import"./createLucideIcon-Bth-IdA6.js";import"./index-Jbur5Ooa.js";import"./index-C9jdFKL2.js";import"./index-BUbelfCo.js";import"./index-BqEA6Zw3.js";import"./circle-x-eB9pV4zn.js";import"./folder-root-D7D27o2o.js";import"./grip-vertical-tucRrCHw.js";const G=[{title:"Assets",href:"/asset"}];function xe({assets:i,filters:m}){const[x,y]=d.useState(m.search||""),[o,h]=d.useState(!1),n=d.useRef(null),N=t=>{c.delete(`/asset/${t}`,{onSuccess:()=>r.success("Asset deleted successfully"),onError:()=>r.error("Failed to delete asset")})},b=t=>{t.key==="Enter"&&c.get("/asset",{...m,search:x},{preserveScroll:!0})},v=()=>{var t;(t=n.current)==null||t.click()},w=async t=>{var f,g,u;const s=(f=t.target.files)==null?void 0:f[0];if(!s)return;if(n.current&&(n.current.value=""),!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(s.type)&&!s.name.match(/\.(xlsx|xls)$/)){r.error("Please select a valid Excel file (.xlsx or .xls)");return}h(!0);const p=new FormData;p.append("file",s);try{const a=await(await fetch("/asset/import",{method:"POST",body:p,headers:{"X-CSRF-TOKEN":((g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"))||""}})).json();a.success?(r.success(a.message),a.error_count>0&&r.warning(`${a.error_count} row(s) had errors and were skipped.`,{description:(u=a.errors)==null?void 0:u.join(`
`)}),c.visit(window.location.pathname,{preserveScroll:!0})):r.error(a.message||"Import failed")}catch{r.error("Failed to import assets. Please try again.")}finally{h(!1)}};return e.jsxs(k,{breadcrumbs:G,children:[e.jsx(C,{title:"Asset Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(F,{children:[e.jsxs(L,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-2xl font-bold",children:"Assets"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institutional assets"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",ref:n,onChange:w,accept:".xlsx,.xls",className:"hidden"}),e.jsxs(l,{variant:"outline",onClick:v,disabled:o,children:[o?e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(S,{className:"h-4 w-4 mr-2"}),o?"Importing...":"Import"]}),e.jsx(j,{href:"/asset/create",children:e.jsxs(l,{children:[e.jsx(D,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]})]}),e.jsx(I,{}),e.jsxs($,{className:"pt-6 space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:e.jsx(R,{type:"text",placeholder:"Search assets... (press Enter)",value:x,onChange:t=>y(t.target.value),onKeyDown:b})}),e.jsx("div",{className:"space-y-3",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary dark:bg-gray-800",children:[e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Asset"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Type"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Category"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Details"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Actions"})]})}),e.jsx("tbody",{children:i.data.length===0?e.jsx("p",{className:"text-muted-foreground text-center",children:"No assets found."}):i.data.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",t.name]}),e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",t.type]}),e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",(s=t.category)==null?void 0:s.name]}),e.jsx("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:t.details}),e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",e.jsx(j,{href:`/asset/${t.id}/edit`,children:e.jsx(l,{variant:"ghost",size:"icon",children:e.jsx(T,{className:"h-4 w-4"})})}),e.jsxs(_,{children:[e.jsx(z,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-destructive hover:text-red-600",children:e.jsx(E,{className:"h-4 w-4"})})}),e.jsxs(H,{children:[e.jsxs(K,{children:[e.jsx(M,{children:"Delete this asset?"}),e.jsxs(q,{children:["Asset ",e.jsx("strong",{children:t.name})," will be permanently deleted."]})]}),e.jsxs(B,{children:[e.jsx(O,{children:"Cancel"}),e.jsx(U,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>N(t.id),children:"Delete"})]})]})]})]})]},t.id)})})]})}),i.links.length>1&&e.jsx("div",{className:"flex justify-center pt-6 flex-wrap gap-2",children:i.links.map((t,s)=>e.jsx(l,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>c.visit(t.url||"",{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},s))})]})]})})]})}export{xe as default};
