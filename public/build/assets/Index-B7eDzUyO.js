import{r as u,j as e,L as z,$ as j,S as N}from"./app-CylfHKRS.js";import{A as B,c as H,P as S,S as K,t as h,d as O,Z as R,a as q,T as Z}from"./app-layout-CVL1Iyn-.js";import{B as l}from"./button-D8HhLbFK.js";import{u as G,a as b,D,c as C,S as w,v as y,b as M,d as J,K as Q,P as U}from"./SortableMenuItem-DKZiTV2U.js";import{C as V,a as W,b as X,c as Y}from"./card-C9gODF9p.js";import{A as _,a as ee,b as se,c as re,d as te,e as ne,f as ae,g as ie,h as de}from"./alert-dialog-CUwoSFNP.js";import"./index-BDAfdMFC.js";import"./index-xdw6RuVl.js";import"./createLucideIcon-0qQpDL3q.js";import"./index-B4YV7qJW.js";import"./app-logo-icon-L8m2nLiQ.js";const le=[{title:"Menu Management",href:"/menus"}];function Ne({menuItems:A}){const[d,x]=u.useState(A),[g,f]=u.useState(!1),[I,E]=u.useState([]),p=G(b(U),b(Q)),P=t=>{E(a=>a.includes(t)?a.filter(r=>r!==t):[...a,t])},T=t=>{const{active:a,over:r}=t;if(!r||a.id===r.id)return;const s=d.findIndex(n=>n.id===Number(a.id)),i=d.findIndex(n=>n.id===Number(r.id));x(n=>M(n,s,i))},k=t=>a=>{const{active:r,over:s}=a;!s||r.id===s.id||x(i=>i.map(n=>{if(n.id!==t||!n.children)return n;const c=n.children.findIndex(m=>m.id===Number(r.id)),o=n.children.findIndex(m=>m.id===Number(s.id));if(c===-1||o===-1)return n;const $=M(n.children,c,o);return{...n,children:$}}))},F=()=>{f(!0);const t=a=>a.map((r,s)=>({id:r.id,order:s+1,children:r.children?t(r.children):[]}));N.post("/menus/reorder",{menus:t(d)},{onSuccess:()=>h.success("Menu order saved successfully"),onError:()=>h.error("Failed to save menu order"),onFinish:()=>f(!1)})},L=t=>{N.delete(`/menus/${t}`,{onSuccess:()=>{x(a=>a.map(r=>{var s;return{...r,children:((s=r.children)==null?void 0:s.filter(i=>i.id!==t))||[]}}).filter(r=>r.id!==t)),h.success("Menu deleted successfully.")},onError:()=>h.error("Failed to delete menu.")})};function v(t,a=0){const r=["ml-0","ml-4","ml-8","ml-12","ml-16","ml-20"];return t.map(s=>{const i=s.children&&s.children.length>0,n=I.includes(s.id),c=r[a]||"ml-20";return e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center justify-between rounded-lg border bg-background px-4 py-3 shadow-sm hover:shadow transition-shadow ${c}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[i?e.jsx("button",{onClick:()=>P(s.id),className:"text-muted-foreground hover:text-primary transition",children:n?e.jsx(O,{className:"h-4 w-4"}):e.jsx(R,{className:"h-4 w-4"})}):e.jsx("span",{className:"w-4"}),e.jsx(J,{id:s.id.toString(),title:s.title})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{href:`/menus/${s.id}/edit`,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-primary",children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsxs(_,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-destructive",children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsxs(se,{children:[e.jsxs(re,{children:[e.jsx(te,{children:"Delete this menu?"}),e.jsxs(ne,{children:['This will permanently delete the menu "',s.title,'".']})]}),e.jsxs(ae,{children:[e.jsx(ie,{children:"Cancel"}),e.jsx(de,{onClick:()=>L(s.id),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]})]}),i&&n&&e.jsx("div",{className:"mt-1",children:e.jsx(D,{sensors:p,collisionDetection:C,onDragEnd:k(s.id),children:e.jsx(w,{items:s.children.map(o=>o.id.toString()),strategy:y,children:v(s.children,a+1)})})})]},s.id)})}return e.jsxs(B,{breadcrumbs:le,children:[e.jsx(z,{title:"Menu Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(V,{className:"w-full",children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-2xl font-bold tracking-tight",children:"Menu Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag & drop to reorder main menus and submenus"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l,{onClick:F,disabled:g,children:[e.jsx(H,{className:"mr-2 h-4 w-4"}),g?"Saving...":"Save Order"]}),e.jsx(j,{href:"/menus/create",children:e.jsxs(l,{children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Add Menu"]})})]})]})}),e.jsx(K,{}),e.jsx(Y,{className:"pt-6",children:d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No menus available"}),e.jsx(j,{href:"/menus/create",children:e.jsxs(l,{children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Add First Menu"]})})]}):e.jsx("div",{className:"space-y-4",children:e.jsx(D,{sensors:p,collisionDetection:C,onDragEnd:T,children:e.jsx(w,{items:d.map(t=>t.id.toString()),strategy:y,children:e.jsx("div",{className:"space-y-3",children:v(d)})})})})})]})})]})}export{Ne as default};
