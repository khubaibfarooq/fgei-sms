import{r as k,j as e,L as v,$ as i,a as g,S as c}from"./app-COmY85AD.js";import{A as D,aa as h,g as C,h as A,T as _}from"./app-layout-Ckul1WjS.js";import{B as l,c as d}from"./button-CE1EO-gU.js";import{C as T,a as S,b as L,c as H}from"./card-Da7OuHbE.js";import{A as $,a as M,b as E,c as F,d as q,e as z,f as B,g as I,h as P}from"./alert-dialog-RwCUNkTh.js";import{D as R,a as V,b as O,c as U,d as G,t as o}from"./index-De82I4qb.js";import{C as p}from"./index-BxJvngRp.js";import"./index-Brqhm3JQ.js";import"./index-CBNFsraN.js";import"./index-DBsGNrAp.js";import"./index-COaArJ-7.js";import"./createLucideIcon-BQYpZ_1M.js";import"./input-A-0B4OKu.js";import"./app-logo-icon-DmjmKt9T.js";import"./circle-x-Dmp6XskS.js";import"./clsx-B-dksMZM.js";import"./folder-root-DZQv5Hr9.js";import"./grip-vertical-ouh8aX24.js";function xe({notifications:t,permissions:n}){const b=[{title:"Dashboard",href:"/dashboard"},{title:"Notifications",href:"/notifications"}],u=async r=>{try{await g.post(`/notifications/${r}/read`),c.reload()}catch{o.error("Failed to mark as read")}},j=async()=>{try{await g.post("/notifications/mark-all-read"),c.reload()}catch{o.error("Failed to mark all as read")}},y=r=>{c.delete(`/notifications/${r}`,{onSuccess:()=>o.success("Notification deleted successfully"),onError:()=>o.error("Failed to delete notification")})},N=r=>{switch(r){case"success":return"border-l-green-500 bg-green-50 dark:bg-green-950/20";case"warning":return"border-l-yellow-500 bg-yellow-50 dark:bg-yellow-950/20";case"error":return"border-l-red-500 bg-red-50 dark:bg-red-950/20";default:return"border-l-blue-500 bg-blue-50 dark:bg-blue-950/20"}},x=r=>new Date(r).toLocaleString(),[s,m]=k.useState(null),f=r=>{const a=document.createElement("DIV"),w=r.replace(/<\/(p|div|li|h[1-6]|tr)>/g," </$1>");return a.innerHTML=w,(a.textContent||a.innerText||"").replace(/\s+/g," ").trim()};return e.jsxs(D,{breadcrumbs:b,children:[e.jsx(v,{title:"Notifications"}),e.jsxs("div",{className:"flex-1 p-4 md:p-6 w-full mx-auto",children:[e.jsxs(T,{children:[e.jsxs(S,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"h-6 w-6"}),e.jsx(L,{className:"text-2xl font-bold",children:"Notifications"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",onClick:j,children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Mark all as read"]}),n.can_add&&e.jsx(i,{href:"/notifications/create",children:e.jsxs(l,{children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Create Notification"]})})]})]}),e.jsxs(H,{className:"space-y-3",children:[t.data.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(h,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"No notifications yet"})]}):t.data.map(r=>e.jsxs("div",{className:d("p-4 rounded-lg border-l-4 flex items-start justify-between gap-4 cursor-pointer hover:bg-muted/50 transition-colors",N(r.type),!r.is_read&&"ring-1 ring-primary/20"),onClick:()=>m(r),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:r.title}),!r.is_read&&e.jsx("span",{className:"h-2 w-2 rounded-full bg-blue-500"}),e.jsx("span",{className:d("text-xs px-1.5 py-0.5 rounded border ml-2",r.type==="success"?"bg-green-100 border-green-200 text-green-700 dark:bg-green-900/30 dark:border-green-800 dark:text-green-300":r.type==="warning"?"bg-yellow-100 border-yellow-200 text-yellow-700 dark:bg-yellow-900/30 dark:border-yellow-800 dark:text-yellow-300":r.type==="error"?"bg-red-100 border-red-200 text-red-700 dark:bg-red-900/30 dark:border-red-800 dark:text-red-300":"bg-blue-100 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300"),children:r.type}),r.link&&e.jsx("span",{className:"text-xs text-muted-foreground border px-1.5 py-0.5 rounded bg-background",children:"Link attached"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:f(r.message)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:x(r.created_at)})]}),e.jsxs("div",{className:"flex gap-1",onClick:a=>a.stopPropagation(),children:[!r.is_read&&e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>u(r.id),title:"Mark as read",children:e.jsx(p,{className:"h-4 w-4"})}),n.can_edit&&e.jsx(i,{href:`/notifications/${r.id}/edit`,children:e.jsx(l,{variant:"ghost",size:"icon",title:"Edit",children:e.jsx(A,{className:"h-4 w-4"})})}),n.can_delete&&e.jsxs($,{children:[e.jsx(M,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",title:"Delete",children:e.jsx(_,{className:"h-4 w-4"})})}),e.jsxs(E,{children:[e.jsxs(F,{children:[e.jsx(q,{children:"Delete this notification?"}),e.jsxs(z,{children:["Notification ",e.jsx("strong",{children:r.title})," will be permanently deleted for all users."]})]}),e.jsxs(B,{children:[e.jsx(I,{children:"Cancel"}),e.jsx(P,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>y(r.id),children:"Delete"})]})]})]})]})]},r.id)),t.last_page>1&&e.jsx("div",{className:"flex justify-center gap-2 pt-4",children:Array.from({length:t.last_page},(r,a)=>a+1).map(r=>e.jsx(i,{href:`/notifications?page=${r}`,className:d("px-3 py-1 rounded",r===t.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:r},r))})]})]}),e.jsx(R,{open:!!s,onOpenChange:r=>!r&&m(null),children:e.jsxs(V,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(O,{children:[e.jsx(U,{className:"text-xl",children:s==null?void 0:s.title}),e.jsx(G,{children:s&&x(s.created_at)})]}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsxs("span",{className:d("px-2 py-1 rounded-md border",s.type==="success"?"bg-green-50 border-green-200 text-green-700":s.type==="warning"?"bg-yellow-50 border-yellow-200 text-yellow-700":s.type==="error"?"bg-red-50 border-red-200 text-red-700":"bg-blue-50 border-blue-200 text-blue-700"),children:["Type: ",s.type.charAt(0).toUpperCase()+s.type.slice(1)]}),s.link&&e.jsx("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 rounded-md border bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100 transition-colors",children:"View Link"})]}),e.jsx("div",{className:"ql-snow mt-4",children:e.jsx("div",{className:"ql-editor p-0",dangerouslySetInnerHTML:{__html:s.message}})})]})]})})]})]})}export{xe as default};
