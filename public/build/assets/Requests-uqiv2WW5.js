import{r as i,m as w,j as e,L as C,S as x}from"./app-BArolwli.js";import{A as E,S as A,B as H,a as D,t as m}from"./app-layout-Db04ZtC5.js";import{B as p}from"./button-BB4cnepi.js";import{C as R,a as I,b as M,c as F}from"./card-CIgoRFiF.js";import{I as h}from"./index-BxfiikOc.js";import{A as P,b as B,c as L,d as T,e as O,f as W,g as z,h as K}from"./alert-dialog-BQDskCIZ.js";import"./index-HU8Kab0-.js";import"./createLucideIcon-Cy3ZFC5Y.js";import"./index-DF7LLozB.js";import"./app-logo-icon-Bu54fPZo.js";const U=[{title:"Help Desks",href:"/helpdesk"}],_=s=>{switch(s){case"Pending":return"bg-yellow-500 text-white";case"Waiting":return"bg-blue-500 text-white";case"Resolved":return"bg-green-500 text-white";case"Rejected":return"bg-red-500 text-white";default:return"bg-gray-500 text-white"}};function ae({helpDesk:s,filters:n,institutes:$,auth:G}){const[c,f]=i.useState(n.search||""),[j,l]=i.useState(!1),[o,r]=i.useState(null),{data:u,setData:d,put:g,processing:b,errors:a,reset:v}=w({status:"",feedback:""}),k=t=>{t.key==="Enter"&&x.get("/helpdesk",{...n,search:c},{preserveScroll:!0})},N=t=>{r(t),d({status:t.status,feedback:t.feedback}),l(!0)},y=t=>{t.preventDefault(),o&&g(`/helpdesk/${o.id}`,{preserveScroll:!0,onSuccess:()=>{l(!1),v(),r(null),m.success("Help desk ticket updated successfully.")},onError:()=>{m.error("Failed to update help desk ticket.")}})};return e.jsxs(E,{breadcrumbs:U,children:[e.jsx(C,{title:"Help Desk Management"}),e.jsxs("div",{className:"flex-1 p-4 md:p-6",children:[e.jsxs(R,{children:[e.jsx(I,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx(M,{className:"text-2xl font-bold",children:"Help Desk"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institutional help desk"})]})}),e.jsx(A,{}),e.jsxs(F,{className:"pt-6 space-y-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:e.jsx(h,{type:"text",placeholder:"Search help desk... (press Enter)",value:c,onChange:t=>f(t.target.value),onKeyDown:k})}),e.jsx("div",{className:"space-y-3",children:!(s!=null&&s.data)||s.data.length===0?e.jsx("p",{className:"text-muted-foreground text-center",children:"No helpdesk found."}):s.data.map(t=>e.jsxs("div",{className:"flex items-center justify-between border px-4 py-3 rounded-md bg-muted/50 hover:bg-muted/70 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"font-medium text-sm text-foreground",children:["#",t.token," | ",t.title]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Institute:",t.institute.name," | Description: ",t.description," â€¢ Status:"," ",e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-semibold ${_(t.status)}`,children:t.status})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>N(t),children:e.jsx(D,{className:"h-4 w-4"})})})]},t.id))}),(s==null?void 0:s.links)&&s.links.length>1&&e.jsx("div",{className:"flex justify-center pt-6 flex-wrap gap-2",children:s.links.map((t,S)=>e.jsx(p,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>x.visit(t.url||"",{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},S))})]})]}),e.jsx(P,{open:j,onOpenChange:l,children:e.jsxs(B,{children:[e.jsxs(L,{children:[e.jsx(T,{children:"Edit Help Desk Ticket"}),e.jsx(O,{children:"Update the status and feedback of the help desk ticket."})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-feedback",className:"block text-sm font-medium text-gray-700",children:"Feedback"}),e.jsx(h,{id:"edit-feedback",type:"text",value:u.feedback,onChange:t=>d("feedback",t.target.value),placeholder:"Enter feedback",className:"mt-1"}),a.feedback&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.feedback})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",value:u.status,onChange:t=>d("status",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Waiting",children:"Waiting"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]}),a.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:a.status})]}),e.jsxs(W,{children:[e.jsx(z,{onClick:()=>r(null),children:"Cancel"}),e.jsx(K,{type:"submit",disabled:b,children:"Update"})]})]})]})})]})]})}export{ae as default};
