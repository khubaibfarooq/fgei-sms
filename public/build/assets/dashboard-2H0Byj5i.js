import{K as A,r as c,j as e,L as E,S as u,a as v}from"./app-a5KzVi4F.js";import{A as H}from"./app-layout-CBiDISNi.js";import{C as b,c as w,a as B,b as P}from"./card-baec-Amg.js";import{D as R,a as U,b as _,c as V,d as W,t as X}from"./index-DEowiKlW.js";import{C as q,a as C}from"./circle-x-C-wNJICG.js";import"./button-BsRpeKGO.js";import"./index-D_IkIjNc.js";import"./createLucideIcon-C9uq6CFw.js";import"./index-CS2i-gBv.js";import"./index-DmJolzer.js";import"./index-2-zIzRg7.js";import"./index-Bgzg1WNd.js";import"./input-CA44BmXE.js";import"./app-logo-icon-C3wpvkqS.js";import"./folder-root-Q3ENwFZ_.js";import"./grip-vertical-BiKI8ylV.js";const z=[{title:"Dashboard",href:"/dashboard"}],S=[{label:"Users",value:420,color:"#3b82f6",redirectlink:""},{label:"Backups",value:80,color:"#10b981",redirectlink:""},{label:"Activity Logs",value:1570,color:"#f59e0b",redirectlink:""}],D=[{bg:"from-blue-50 to-blue-100",border:"border-blue-200",header:"bg-blue-500",text:"text-blue-800",accent:"bg-blue-200/50"},{bg:"from-green-50 to-green-100",border:"border-green-200",header:"bg-green-500",text:"text-green-800",accent:"bg-green-200/50"},{bg:"from-amber-50 to-amber-100",border:"border-amber-200",header:"bg-amber-500",text:"text-amber-800",accent:"bg-amber-200/50"}],G=s=>s.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),g=s=>!s||s.length===0?[]:Object.keys(s[0]),J=(s,o)=>{if(s==null)return"-";if(typeof s=="number")return s.toLocaleString();if(typeof s=="string"){if(["balance","cost","amount","price","value","total_cost","total_amount"].some(d=>o==null?void 0:o.toLowerCase().includes(d))){const d=parseFloat(s);if(!isNaN(d))return`${d.toLocaleString()}`}return s}return String(s)};function ue(){const{props:s}=A();s.auth.user;const o=s.cards||[],[p,f]=c.useState(S),[d,y]=c.useState(!1),[Q,Y]=c.useState({}),[x,j]=c.useState({0:5,1:5,2:5}),[L,h]=c.useState(!1),[i,N]=c.useState(null),[$,k]=c.useState(!1),F=async(t,r)=>{if(t&&t.includes("/dashboard/completion")){k(!0),h(!0),N(null);try{const a=await v.get(t);N(a.data)}catch(a){console.error(a),X.error("Failed to load details"),h(!1)}finally{k(!1)}}else t&&u.visit(t)},T=[{title:s.title1||"Funds",data:s.tab1||[],columns:g(s.tab1||[]),link:s.link1||""},{title:s.title2||"Tab2",data:s.tab2||[],columns:g(s.tab2||[]),link:s.link2||""},{title:s.title3||"Tab3",data:s.tab3||[],columns:g(s.tab3||[]),link:s.link3||""}];c.useEffect(()=>{if(o.length===0)return;(async()=>{y(!0);try{const r=o.map(async l=>{try{const n=await v.get(l.link);return{label:l.title,value:n.data.count||0,color:l.color,redirectlink:l.redirectlink}}catch(n){return console.error(`Failed to fetch count for ${l.title}:`,n),{label:l.title,value:0,color:l.color,redirectlink:l.redirectlink}}}),a=await Promise.all(r);f(a)}catch(r){console.error("Failed to fetch summary data:",r)}finally{y(!1)}})()},[o]);const M=t=>{j(r=>({...r,[t]:(r[t]||5)+5}))},K=t=>{j(r=>({...r,[t]:Math.max(5,(r[t]||5)-5)}))};return e.jsxs(H,{breadcrumbs:z,children:[e.jsx(E,{title:"Dashboard"}),e.jsxs("div",{className:"flex flex-col gap-6 p-5",children:[e.jsx("div",{className:"relative px-8 py-6 text-center",children:e.jsx(b,{className:"inline-block bg-primary/95 backdrop-blur-sm shadow-2xl border-0 max-w-3xl mx-auto mb-2 p-5",style:{borderBottom:"6px solid rgba(0,0,255,0.7)"},children:e.jsx(w,{className:"pt-5 px-10",children:e.jsx("h1",{className:"text-2xl md:text-4xl font-bold text-white",children:"School Management System"})})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:(d?S:p).map((t,r)=>{var n;const a=o[r],l=(a==null?void 0:a.icon)||["Users","HardDrive","LogIcon"][r%3];return e.jsx("div",{onClick:()=>{var m;(m=t.redirectlink)!=null&&m.includes("/dashboard/completion")?F(t.redirectlink):t.redirectlink&&u.visit(t.redirectlink)},className:"cursor-pointer",children:e.jsx(b,{redirectLink:(n=t.redirectlink)!=null&&n.includes("/dashboard/completion")?void 0:t.redirectlink,number:d?"...":t.label==="Funds"||t.label==="Institutes Funds"?`${(t.value/1e6).toFixed(2)}M`:t.value,title:t.label,icon:l,iconBgColor:t.color,changeColorOnHover:!0,className:"shadow-lg p-5 hover:scale-110 hover:-translate-y-2 transition-all duration-300 ease-in-out active:scale-95"})},r)})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:T.map((t,r)=>{const a=D[r%D.length];return e.jsxs(b,{className:`bg-gradient-to-br ${a.bg} ${a.border} shadow-lg rounded-xl overflow-hidden dark:bg-gray-800 dark:border-gray-700`,children:[e.jsx(B,{className:`${a.header} text-white px-6 py-4 dark:bg-gray-700`,children:e.jsxs(P,{className:"text-lg font-semibold flex items-center",children:[e.jsx("span",{className:"w-3 h-3 bg-white rounded-full mr-2"}),t.title]})}),e.jsx(w,{className:"p-0",children:t.data.length>0?e.jsxs("div",{className:"overflow-x-auto px-4 py-3",children:[e.jsx("div",{className:"shadow-sm rounded-md overflow-hidden",children:e.jsxs("table",{className:"w-full table-fixed",children:[e.jsx("thead",{className:`${a.accent} dark:bg-gray-600`,children:e.jsx("tr",{children:t.columns.map((l,n)=>l!=="Key"&&e.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium dark:text-gray-200",style:{color:a.header.replace("bg-","text-")+"900"},children:G(l)},n))})}),e.jsx("tbody",{children:t.data.slice(0,x[r]||5).map((l,n)=>e.jsx("tr",{onClick:()=>{l.Key&&t.link&&u.visit(`${t.link}${l.Key}`)},className:`border-b ${t.link?"cursor-pointer":""} ${a.border}/30 transition-all hover:opacity-95 hover:shadow-md
                          ${n%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700"}`,children:t.columns.map((m,O)=>m!=="Key"&&e.jsx("td",{className:`py-3 px-4 text-sm md:text-lg ${a.text}`,children:J(l[m],m)},O))},n))})]})}),t.data.length>5&&e.jsxs("div",{className:"p-4 text-center border-t border-gray-200 bg-gray-50 flex gap-2 justify-center",children:[(x[r]||5)<t.data.length&&e.jsxs("button",{type:"button",onClick:()=>M(r),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border border-transparent bg-blue-500 text-white shadow-sm hover:bg-blue-600 focus:outline-none transition-colors",children:["Show More (",t.data.length-(x[r]||5)," remaining)"]}),(x[r]||5)>5&&e.jsx("button",{type:"button",onClick:()=>K(r),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border border-transparent bg-gray-400 text-white shadow-sm hover:bg-gray-500 focus:outline-none transition-colors",children:"Show Less"})]})]}):e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"No data available"})})]},r)})}),e.jsx(R,{open:L,onOpenChange:h,children:e.jsxs(U,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(_,{children:[e.jsxs(V,{className:"text-xl",children:["Completion Details: ",(i==null?void 0:i.institute)||"Loading..."]}),e.jsx(W,{children:"Detailed breakdown of invalid or missing criteria."})]}),$?e.jsx("div",{className:"flex justify-center p-8",children:"Loading details..."}):i?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-semibold text-lg",children:"Total Score"}),e.jsxs("span",{className:`text-2xl font-bold ${i.percentage===100?"text-green-600":i.percentage<50?"text-red-600":"text-yellow-600"}`,children:[i.percentage,"%"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-muted-foreground uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Criteria"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Weight"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Message"})]})}),e.jsx("tbody",{className:"divide-y",children:i.criteria.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:t.name}),e.jsxs("td",{className:"px-4 py-3 text-right text-muted-foreground",children:[t.weight,"%"]}),e.jsx("td",{className:"px-4 py-3 text-center",children:t.completed?e.jsx(q,{className:"w-5 h-5 text-green-500 mx-auto"}):e.jsx(C,{className:"w-5 h-5 text-red-500 mx-auto"})}),e.jsx("td",{className:`px-4 py-3 ${t.completed?"text-green-600":"text-red-600"}`,children:t.message})]},r))})]})}),i.percentage<100&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-blue-50 p-3 rounded border border-blue-100 dark:bg-blue-900/20 dark:border-blue-900",children:["Note: Please address the items marked with ",e.jsx(C,{className:"w-3 h-3 inline text-red-500"})," to reach 100% completion."]})]}):e.jsx("div",{className:"text-center text-red-500",children:"Failed to load details."})]})})]})]})}export{ue as default};
