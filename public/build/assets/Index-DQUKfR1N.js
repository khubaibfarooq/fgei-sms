import{r as d,j as e,L as P,$ as w,S as i}from"./app-CsRabZIE.js";import{A as Q,P as K,S as V,e as G,T as J,t as k}from"./app-layout-AmNCWhto.js";import{B as h}from"./button-DKUJQQbh.js";import{C as U,a as W,b as X,c as Y}from"./card-hbcu5ndH.js";import{I as _}from"./input-Bg9HEyWP.js";import{A as Z,a as ee,b as te,c as se,d as ae,e as le,f as re,g as ne,h as ce}from"./alert-dialog-DLxZD-ff.js";import"./index-DB1ngrAf.js";import"./createLucideIcon-D1E5yMEV.js";import"./index-DPeRmpZB.js";import"./app-logo-icon-mJQ_HioP.js";import"./folder-root-UxgFfGbj.js";import"./grip-vertical-DQLhSE1M.js";const oe=[{title:"Institute Assets",href:"/institute-assets"}];function ve({instituteAssets:x,filters:r,blocks:b,rooms:$,categories:f,permissions:l,assets:N}){const[u,v]=d.useState(r.search||""),[n,y]=d.useState(r.block||""),[m,p]=d.useState(r.room||""),[c,C]=d.useState(r.category||""),[j,A]=d.useState(r.details||!1),[S,g]=d.useState(r.asset||""),I=b?Object.entries(b).map(([t,s])=>({id:t,name:s})):[],B=f?Object.entries(f).map(([t,s])=>({id:t,name:s})):[],F=N?Object.entries(N).map(([t,s])=>({id:t,name:s})):[],o=t=>{i.get("/institute-assets",{...r,...t},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters","assets"]})},R=t=>{t.key==="Enter"&&o({search:u,category:c})},T=t=>{const s=t.target.value;y(s),p(""),o({block:s,room:"",category:c})},E=t=>{const s=t.target.value;p(s),o({room:s,category:c})},L=t=>{const s=t.target.value;C(s),g(""),o({block:n,room:m,category:s,asset:""})},O=t=>{A(t),o({details:t,search:u,block:n,room:m,category:c})},q=t=>{const s=t.target.value;g(s),o({asset:s})},z=()=>{v(""),y(""),p(""),C(""),g(""),A(!1),i.get("/institute-assets",{},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters","assets"]})},H=t=>{i.delete(`/institute-assets/${t}`,{onSuccess:()=>k.success("Institute asset deleted successfully"),onError:()=>k.error("Failed to delete institute asset")})};return e.jsxs(Q,{breadcrumbs:oe,children:[e.jsx(P,{title:"Institute Asset Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(U,{children:[e.jsxs(W,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-2xl font-bold",children:"Institute Assets"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institute asset inventory"})]}),(l==null?void 0:l.can_add)&&e.jsx(w,{href:"/institute-assets/create",children:e.jsxs(h,{children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]}),e.jsx(V,{}),e.jsxs(Y,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-wrap items-center",children:[e.jsx(_,{placeholder:"Search assets... (press Enter)",value:u,onChange:t=>v(t.target.value),onKeyDown:R,className:"md:w-64"}),e.jsxs("select",{value:c,onChange:L,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),B.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:S,onChange:q,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Assets"}),F.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:n,onChange:T,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Blocks"}),I.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:m,onChange:E,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:n?"All Rooms in This Block":"All Rooms"}),$.filter(t=>{var s;return!n||((s=t.block)==null?void 0:s.id)===Number(n)}).map(t=>e.jsxs("option",{value:t.id,children:[t.name,t.block&&` (${t.block.name})`]},t.id))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{type:"checkbox",checked:j,onChange:t=>O(t.target.checked),id:"details-mode"}),e.jsxs("label",{htmlFor:"details-mode",className:"cursor-pointer select-none font-medium",children:[j?"Detailed View":"Summary View"," — Show Details"]})]}),(u||n||m||c||S)&&e.jsx(h,{onClick:z,variant:"ghost",children:"Clear Filters"})]}),e.jsx("div",{className:"overflow-x-auto",children:x.data.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-10",children:"No assets found."}):e.jsxs("table",{className:"w-full min-w-max border-collapse rounded-lg overflow-hidden shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white",children:[e.jsx("th",{className:"border p-3 text-left",children:"Asset Name"}),j?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border p-3 text-left",children:"Category"}),e.jsx("th",{className:"border p-3 text-left",children:"Details"}),e.jsx("th",{className:"border p-3 text-center",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-left",children:"Added Date"}),e.jsx("th",{className:"border p-3 text-left",children:"Room / Block"}),e.jsx("th",{className:"border p-3 text-left",children:"Actions"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border p-3 text-center",children:"Total Quantity"}),e.jsx("th",{className:"border p-3 text-center",children:"Rooms"})]})]})}),e.jsx("tbody",{children:x.data.map((t,s)=>{var D;if(!j)return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:t.name}),e.jsx("td",{className:"border p-3 text-center text-lg font-bold text-green-600",children:t.total_qty}),e.jsx("td",{className:"border p-3 text-center text-amber-600",children:t.locations_count>0?e.jsx("a",{className:"hover:underline cursor-pointer font-semibold",onClick:M=>{M.preventDefault(),i.get("/institute-assets",{details:!0,asset:t.asset_id})},children:t.locations_count}):t.locations_count})]},`${t.name}-${s}`);if(!t.asset)return e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"border p-3 text-center text-muted-foreground",children:"Loading details..."})},s);const a=t;return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:a.asset.name}),e.jsx("td",{className:"border p-3",children:((D=a.asset.category)==null?void 0:D.name)||"—"}),e.jsx("td",{className:"border p-3 text-sm",children:a.details||"—"}),e.jsx("td",{className:"border p-3 text-center font-bold text-lg",children:a.current_qty}),e.jsx("td",{className:"border p-3 text-sm",children:new Date(a.added_date).toLocaleDateString()}),e.jsx("td",{className:"border p-3 text-sm",children:a.room?`${a.room.name}${a.room.block?` (${a.room.block.name})`:""}`:"—"}),e.jsx("td",{className:"border p-3",children:e.jsxs("div",{className:"flex gap-1",children:[(l==null?void 0:l.can_edit)&&e.jsx(w,{href:`/institute-assets/${a.id}/edit`,children:e.jsx(h,{variant:"ghost",size:"icon",children:e.jsx(G,{className:"h-4 w-4"})})}),(l==null?void 0:l.can_delete)&&e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"icon",className:"text-destructive",children:e.jsx(J,{className:"h-4 w-4"})})}),e.jsxs(te,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Delete Entry?"}),e.jsxs(le,{children:[e.jsx("strong",{children:a.asset.name})," (Qty: ",a.current_qty,") will be deleted."]})]}),e.jsxs(re,{children:[e.jsx(ne,{children:"Cancel"}),e.jsx(ce,{className:"bg-destructive",onClick:()=>H(a.id),children:"Delete"})]})]})]})]})})]},a.id)})})]})}),x.links.length>3&&e.jsx("div",{className:"flex justify-center gap-2 flex-wrap pt-6",children:x.links.map((t,s)=>e.jsx(h,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&i.visit(t.url,{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},s))})]})]})})]})}export{ve as default};
