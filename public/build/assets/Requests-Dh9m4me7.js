import{r as l,m as D,j as e,L as R,S as x}from"./app-CLwxkXUP.js";import{A as T,S as F,k as I,t as g}from"./app-layout-CUmrzaPo.js";import{B as p}from"./button-DuAK8b4F.js";import{C as M,a as P,b as _,c as L}from"./card-DfL618du.js";import{I as j}from"./input-JnCjozAc.js";import{S as W,a as O,b as z,c as B,d as a}from"./select-DyUe8wO-.js";import{A as K,b as U,c as V,d as $,e as G,f as J,g as Q,h as X}from"./alert-dialog-D6aI0GFQ.js";import{a as b}from"./dateFormatter-D72XrzRE.js";import"./index-BI0UwGaV.js";import"./createLucideIcon-B0DIMvnH.js";import"./index-CaGIkhhj.js";import"./app-logo-icon-BuoNFaHC.js";import"./folder-root-DgS7d-4r.js";import"./grip-vertical-CJBsC5J7.js";import"./index-BlXl9JiL.js";import"./index-D0sqXo3p.js";const Y=[{title:"Help Desks",href:"/helpdesk"}],Z=s=>{switch(s){case"Pending":return"bg-yellow-500 text-white";case"Waiting":return"bg-blue-500 text-white";case"Resolved":return"bg-green-500 text-white";case"Rejected":return"bg-red-500 text-white";default:return"bg-gray-500 text-white"}};function je({helpDesk:s,filters:r,institutes:q,auth:ee}){const[i,f]=l.useState(r.search||""),[m,y]=l.useState(r.status||""),[k,n]=l.useState(!1),[h,c]=l.useState(null),{data:u,setData:o,put:N,processing:v,errors:d,reset:S}=D({status:"",feedback:""}),w=t=>{t.key==="Enter"&&x.get("/helpdesk",{...r,search:i,status:m},{preserveScroll:!0})},C=t=>{y(t),x.get("/helpdesk",{...r,search:i,status:t},{preserveScroll:!0})},A=t=>{c(t),o({status:t.status,feedback:t.feedback}),n(!0)},E=t=>{t.preventDefault(),h&&N(`/helpdesk/${h.id}`,{preserveScroll:!0,onSuccess:()=>{n(!1),S(),c(null),g.success("Help desk ticket updated successfully.")},onError:()=>{g.error("Failed to update help desk ticket.")}})};return e.jsxs(T,{breadcrumbs:Y,children:[e.jsx(R,{title:"Help Desk Management"}),e.jsxs("div",{className:"flex-1 p-4 md:p-6",children:[e.jsxs(M,{children:[e.jsx(P,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:e.jsxs("div",{children:[e.jsx(_,{className:"text-2xl font-bold",children:"Help Desk"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institutional help desk"})]})}),e.jsx(F,{}),e.jsxs(L,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx(j,{type:"text",placeholder:"Search help desk... (press Enter)",value:i,onChange:t=>f(t.target.value),onKeyDown:w}),e.jsxs(W,{value:m,onValueChange:C,children:[e.jsx(O,{children:e.jsx(z,{})}),e.jsxs(B,{children:[e.jsx(a,{value:"all",children:"All"}),e.jsx(a,{value:"pending",children:"Pending"}),e.jsx(a,{value:"waiting",children:"Waiting"}),e.jsx(a,{value:"resolved",children:"Resolved"}),e.jsx(a,{value:"rejected",children:"Rejected"})]})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary dark:bg-gray-800 text-center",children:[e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Institute"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Token"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Created At"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Feedback"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Feedback At"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Title"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Descriptions"}),e.jsx("th",{className:"border p-2  text-sm font-medium text-white dark:text-gray-200",children:"Status"}),e.jsx("th",{className:"border p-2 text-sm font-medium text-white dark:text-gray-200",children:"Actions"})]})}),e.jsx("tbody",{children:!(s!=null&&s.data)||s.data.length===0?e.jsx("p",{className:"text-muted-foreground text-center",children:"No Request found."}):s.data.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700 text-center",children:[e.jsxs("td",{className:"border text-sm text-gray-900 dark:text-gray-100",children:[t.institute.id,"-",t.institute.name," (",t.institute.type,")"]}),e.jsxs("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:["#",t.token]}),e.jsx("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:t.created_at?b(new Date(t.created_at)):""}),e.jsx("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:t.feedback}),e.jsx("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:t.feedback_date?b(new Date(t.feedback_date)):""}),e.jsx("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:t.title}),e.jsxs("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:[t.description," "]}),e.jsxs("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:["  ",e.jsx("span",{className:`inline-block px-2 py-1 rounded-full text-xs font-semibold ${Z(t.status)}`,children:t.status})," "]}),e.jsxs("td",{className:"border  text-sm text-gray-900 dark:text-gray-100",children:["    ",e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>A(t),children:e.jsx(I,{className:"h-4 w-4"})})," "]})]},t.id))})]})}),(s==null?void 0:s.links)&&s.links.length>1&&e.jsx("div",{className:"flex justify-center pt-6 flex-wrap gap-2",children:s.links.map((t,H)=>e.jsx(p,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>x.visit(t.url||"",{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},H))})]})]}),e.jsx(K,{open:k,onOpenChange:n,children:e.jsxs(U,{children:[e.jsxs(V,{children:[e.jsx($,{children:"Edit Help Desk Ticket"}),e.jsx(G,{children:"Update the status and feedback of the help desk ticket."})]}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"edit-feedback",className:"block text-sm font-medium text-gray-700",children:"Feedback"}),e.jsx(j,{id:"edit-feedback",type:"text",value:u.feedback,onChange:t=>o("feedback",t.target.value),placeholder:"Enter feedback",className:"mt-1"}),d.feedback&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.feedback})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("select",{id:"status",value:u.status,onChange:t=>o("status",t.target.value),className:"mt-1 block w-full border-gray-300 rounded-md shadow-sm",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Waiting",children:"Waiting"}),e.jsx("option",{value:"Resolved",children:"Resolved"}),e.jsx("option",{value:"Rejected",children:"Rejected"})]}),d.status&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.status})]}),e.jsxs(J,{children:[e.jsx(Q,{onClick:()=>c(null),children:"Cancel"}),e.jsx(X,{type:"submit",disabled:v,children:"Update"})]})]})]})})]})]})}export{je as default};
