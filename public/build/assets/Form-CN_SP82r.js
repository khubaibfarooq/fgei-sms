import{m as N,j as e,L as S,$ as _,S as m,b as f}from"./app-Dz6Y4NYM.js";import{A as R,S as C,a as w,j as A}from"./app-layout-Dcngf0AY.js";import{B as j}from"./button-CTyV7QiL.js";import{C as L,a as E,b as F,c as U}from"./card-a7ph9NvF.js";import{I as p}from"./input-Rem8VCBE.js";import{L as n}from"./label-B8JYFY8F.js";import{C as g}from"./combobox-slvlq3jx.js";import"./index-BpFDX6Ra.js";import"./createLucideIcon-C64l_bc1.js";import"./index-DfhaLKpz.js";import"./app-logo-icon-CAPFRVWw.js";import"./folder-root-DzANYbkG.js";import"./grip-vertical-ByQHJAo3.js";import"./popover-DyEX5KGz.js";function Q({room:s,roomTypes:c,blocks:o}){var h,x;const r=!!s,{data:a,setData:d,processing:u,reset:v}=N({name:(s==null?void 0:s.name)||"",area:(s==null?void 0:s.area)||0,room_type_id:(s==null?void 0:s.room_type_id)||0,block_id:(s==null?void 0:s.block_id)||0,img:(s==null?void 0:s.img)||null}),b=t=>{t.preventDefault();const i=new FormData;Object.keys(a).forEach(l=>{if(!(a[l]===null||a[l]==="")){if(l==="img"){a[l]instanceof File&&i.append(l,a[l]);return}i.append(l,a[l])}}),r?(i.append("_method","PUT"),m.post(`/rooms/${s.id}`,i,{preserveScroll:!0,preserveState:!0,onSuccess:()=>{m.get("/rooms")}})):m.post("/rooms",i,{onSuccess:()=>{v()}})},y=[{title:"Rooms",href:"/rooms"},{title:r?"Edit Room":"Add Room",href:"#"}];return e.jsxs(R,{breadcrumbs:y,children:[e.jsx(S,{title:r?"Edit Room":"Add Room"}),e.jsx("div",{className:"flex-1 p-4 md:p-6 w-[70vw] mx-auto",children:e.jsxs(L,{children:[e.jsxs(E,{children:[e.jsx(F,{className:"text-2xl font-bold",children:r?"Edit Room":"Add Room"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?"Edit room details":"Create a new room"})]}),e.jsx(C,{}),e.jsx(U,{className:"pt-6",children:e.jsxs("form",{onSubmit:b,className:"space-y-6",encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"name",children:"Room Name"}),e.jsx(p,{id:"name",value:a.name,onChange:t=>d("name",t.target.value),placeholder:"Enter room name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"area",children:"Area (sq ft)"}),e.jsx(p,{id:"area",type:"number",value:a.area,onChange:t=>d("area",Number(t.target.value)),placeholder:"Enter area"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"room_type_id",children:"Room Type"}),e.jsx(g,{entity:"room_type_id",value:(h=a.room_type_id)==null?void 0:h.toString(),onChange:t=>{d("room_type_id",parseInt(t))},options:c.map(t=>({id:t.id.toString(),name:t.name})),includeAllOption:!1,placeholder:"Select Room Type"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"block_id",children:"Block"}),e.jsx(g,{entity:"block_id",value:(x=a.block_id)==null?void 0:x.toString(),onChange:t=>{d("block_id",parseInt(t))},options:o.map(t=>({id:t.id.toString(),name:t.name})),includeAllOption:!1,placeholder:"Select Block"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"img",children:"Image"}),e.jsx(p,{id:"img",type:"file",accept:"image/*",onChange:t=>{var i;return d("img",((i=t.target.files)==null?void 0:i[0])||null)}}),e.jsx(n,{children:"Image"}),e.jsx(B,{dataImg:a.img})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-6",children:[e.jsx(_,{href:"/rooms",children:e.jsxs(j,{type:"button",variant:"secondary",children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs(j,{type:"submit",disabled:u,children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),u?r?"Saving...":"Adding...":r?"Save Changes":"Add Room"]})]})]})})]})})]})}function B({dataImg:s}){const[c,o]=f.useState(()=>s&&typeof s=="string"?`/assets/${s}`:null);return f.useEffect(()=>{if(s instanceof File){const r=URL.createObjectURL(s);return o(r),()=>URL.revokeObjectURL(r)}else o(typeof s=="string"&&s?`/assets/${s}`:null)},[s]),c?e.jsx("img",{src:c,alt:"Layout",className:"w-full h-48 object-cover rounded"}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No image uploaded."})}export{Q as default};
