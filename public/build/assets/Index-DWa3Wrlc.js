import{r as k,j as e,L as v,$ as i,a as g,S as c}from"./app-Blvsyb6G.js";import{A as D,ae as h,P as C,k as A,T as _,D as T,b as S,c as L,d as H,e as $,t as d}from"./app-layout-BBJ7Qdr4.js";import{B as l,c as n}from"./button--ZMuj3Oj.js";import{C as M,a as E,b as F,c as P}from"./card-CqZn9SGv.js";import{A as q,a as z,b as B,c as I,d as R,e as V,f as O,g as U,h as G}from"./alert-dialog-KTDE3Fmi.js";import{C as p}from"./index-eURHtWlR.js";import"./input-BI_huiBj.js";import"./index-DxfRe0hn.js";import"./createLucideIcon-CoikvWNb.js";import"./app-logo-icon-BwG4INC6.js";import"./folder-root-DfA4zM8L.js";import"./grip-vertical-D-zQ8Laz.js";function le({notifications:t,permissions:o}){const b=[{title:"Dashboard",href:"/dashboard"},{title:"Notifications",href:"/notifications"}],u=async r=>{try{await g.post(`/notifications/${r}/read`),c.reload()}catch{d.error("Failed to mark as read")}},j=async()=>{try{await g.post("/notifications/mark-all-read"),c.reload()}catch{d.error("Failed to mark all as read")}},y=r=>{c.delete(`/notifications/${r}`,{onSuccess:()=>d.success("Notification deleted successfully"),onError:()=>d.error("Failed to delete notification")})},N=r=>{switch(r){case"success":return"border-l-green-500 bg-green-50 dark:bg-green-950/20";case"warning":return"border-l-yellow-500 bg-yellow-50 dark:bg-yellow-950/20";case"error":return"border-l-red-500 bg-red-50 dark:bg-red-950/20";default:return"border-l-blue-500 bg-blue-50 dark:bg-blue-950/20"}},x=r=>new Date(r).toLocaleString(),[s,m]=k.useState(null),f=r=>{const a=document.createElement("DIV"),w=r.replace(/<\/(p|div|li|h[1-6]|tr)>/g," </$1>");return a.innerHTML=w,(a.textContent||a.innerText||"").replace(/\s+/g," ").trim()};return e.jsxs(D,{breadcrumbs:b,children:[e.jsx(v,{title:"Notifications"}),e.jsxs("div",{className:"flex-1 p-4 md:p-6 w-full mx-auto",children:[e.jsxs(M,{children:[e.jsxs(E,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"h-6 w-6"}),e.jsx(F,{className:"text-2xl font-bold",children:"Notifications"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(l,{variant:"outline",onClick:j,children:[e.jsx(p,{className:"h-4 w-4 mr-2"}),"Mark all as read"]}),o.can_add&&e.jsx(i,{href:"/notifications/create",children:e.jsxs(l,{children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Create Notification"]})})]})]}),e.jsxs(P,{className:"space-y-3",children:[t.data.length===0?e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(h,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-lg",children:"No notifications yet"})]}):t.data.map(r=>e.jsxs("div",{className:n("p-4 rounded-lg border-l-4 flex items-start justify-between gap-4 cursor-pointer hover:bg-muted/50 transition-colors",N(r.type),!r.is_read&&"ring-1 ring-primary/20"),onClick:()=>m(r),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-semibold",children:r.title}),!r.is_read&&e.jsx("span",{className:"h-2 w-2 rounded-full bg-blue-500"}),e.jsx("span",{className:n("text-xs px-1.5 py-0.5 rounded border ml-2",r.type==="success"?"bg-green-100 border-green-200 text-green-700 dark:bg-green-900/30 dark:border-green-800 dark:text-green-300":r.type==="warning"?"bg-yellow-100 border-yellow-200 text-yellow-700 dark:bg-yellow-900/30 dark:border-yellow-800 dark:text-yellow-300":r.type==="error"?"bg-red-100 border-red-200 text-red-700 dark:bg-red-900/30 dark:border-red-800 dark:text-red-300":"bg-blue-100 border-blue-200 text-blue-700 dark:bg-blue-900/30 dark:border-blue-800 dark:text-blue-300"),children:r.type}),r.link&&e.jsx("span",{className:"text-xs text-muted-foreground border px-1.5 py-0.5 rounded bg-background",children:"Link attached"})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:f(r.message)}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:x(r.created_at)})]}),e.jsxs("div",{className:"flex gap-1",onClick:a=>a.stopPropagation(),children:[!r.is_read&&e.jsx(l,{variant:"ghost",size:"icon",onClick:()=>u(r.id),title:"Mark as read",children:e.jsx(p,{className:"h-4 w-4"})}),o.can_edit&&e.jsx(i,{href:`/notifications/${r.id}/edit`,children:e.jsx(l,{variant:"ghost",size:"icon",title:"Edit",children:e.jsx(A,{className:"h-4 w-4"})})}),o.can_delete&&e.jsxs(q,{children:[e.jsx(z,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",title:"Delete",children:e.jsx(_,{className:"h-4 w-4"})})}),e.jsxs(B,{children:[e.jsxs(I,{children:[e.jsx(R,{children:"Delete this notification?"}),e.jsxs(V,{children:["Notification ",e.jsx("strong",{children:r.title})," will be permanently deleted for all users."]})]}),e.jsxs(O,{children:[e.jsx(U,{children:"Cancel"}),e.jsx(G,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>y(r.id),children:"Delete"})]})]})]})]})]},r.id)),t.last_page>1&&e.jsx("div",{className:"flex justify-center gap-2 pt-4",children:Array.from({length:t.last_page},(r,a)=>a+1).map(r=>e.jsx(i,{href:`/notifications?page=${r}`,className:n("px-3 py-1 rounded",r===t.current_page?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:r},r))})]})]}),e.jsx(T,{open:!!s,onOpenChange:r=>!r&&m(null),children:e.jsxs(S,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[e.jsxs(L,{children:[e.jsx(H,{className:"text-xl",children:s==null?void 0:s.title}),e.jsx($,{children:s&&x(s.created_at)})]}),s&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 text-sm",children:[e.jsxs("span",{className:n("px-2 py-1 rounded-md border",s.type==="success"?"bg-green-50 border-green-200 text-green-700":s.type==="warning"?"bg-yellow-50 border-yellow-200 text-yellow-700":s.type==="error"?"bg-red-50 border-red-200 text-red-700":"bg-blue-50 border-blue-200 text-blue-700"),children:["Type: ",s.type.charAt(0).toUpperCase()+s.type.slice(1)]}),s.link&&e.jsx("a",{href:s.link,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 rounded-md border bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100 transition-colors",children:"View Link"})]}),e.jsx("div",{className:"ql-snow mt-4",children:e.jsx("div",{className:"ql-editor p-0",dangerouslySetInnerHTML:{__html:s.message}})})]})]})})]})]})}export{le as default};
