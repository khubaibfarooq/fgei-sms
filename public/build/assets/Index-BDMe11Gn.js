import{r as d,j as e,L as Q,$ as D,S as i}from"./app-BC4g3-Sh.js";import{A as K,e as P,S as G,f as J,T as U}from"./app-layout-D2DE53xZ.js";import{B as u}from"./button-NzCsb15S.js";import{C as V,a as W,b as X,c as Y}from"./card-D3FFSLEP.js";import{I as k}from"./input-B38sVd47.js";import{A as Z,a as ee,b as te,c as se,d as ae,e as le,f as re,g as ne,h as oe}from"./alert-dialog-ESOynmcv.js";import{t as _}from"./index-D5grnXr_.js";import"./index-q3AzPoZD.js";import"./createLucideIcon-CuuBrquh.js";import"./index-DXUZiMwj.js";import"./index-B8QJ6AuC.js";import"./index-QP_HzfFt.js";import"./index-D368l6qP.js";import"./app-logo-icon-CWQ_cq_6.js";import"./circle-x-BFsT17H-.js";import"./folder-root-Djpr5ABJ.js";import"./grip-vertical-DpyLEmjT.js";const ce=[{title:"Institute Assets",href:"/institute-assets"}];function Se({instituteAssets:m,filters:r,blocks:f,rooms:$,categories:b,permissions:l,assets:N}){const[h,v]=d.useState(r.search||""),[n,y]=d.useState(r.block||""),[x,j]=d.useState(r.room||""),[o,w]=d.useState(r.category||""),[p,C]=d.useState(r.details||!1),[A,g]=d.useState(r.asset||""),I=f?Object.entries(f).map(([t,s])=>({id:t,name:s})):[],B=b?Object.entries(b).map(([t,s])=>({id:t,name:s})):[],F=N?Object.entries(N).map(([t,s])=>({id:t,name:s})):[],c=t=>{i.get("/institute-assets",{...r,...t},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters","assets"]})},R=t=>{t.key==="Enter"&&c({search:h,category:o})},T=t=>{const s=t.target.value;y(s),j(""),c({block:s,room:"",category:o})},E=t=>{const s=t.target.value;j(s),c({room:s,category:o})},L=t=>{const s=t.target.value;w(s),g(""),c({block:n,room:x,category:s,asset:""})},O=t=>{C(t),c({details:t,search:h,block:n,room:x,category:o})},q=t=>{const s=t.target.value;g(s),c({asset:s})},M=()=>{v(""),y(""),j(""),w(""),g(""),C(!1),i.get("/institute-assets",{},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters","assets"]})},z=t=>{i.delete(`/institute-assets/${t}`,{onSuccess:()=>_.success("Institute asset deleted successfully"),onError:()=>_.error("Failed to delete institute asset")})};return e.jsxs(K,{breadcrumbs:ce,children:[e.jsx(Q,{title:"Institute Asset Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(V,{children:[e.jsxs(W,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-2xl font-bold",children:"Institute Assets"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institute asset inventory"})]}),(l==null?void 0:l.can_add)&&e.jsx(D,{href:"/institute-assets/create",className:"w-full md:w-auto",children:e.jsxs(u,{className:"w-full",children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]}),e.jsx(G,{}),e.jsxs(Y,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-wrap items-center",children:[e.jsx(k,{placeholder:"Search assets... (press Enter)",value:h,onChange:t=>v(t.target.value),onKeyDown:R,className:"w-full md:w-64"}),e.jsxs("select",{value:o,onChange:L,className:"w-full md:w-auto px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),B.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:A,onChange:q,className:"w-full md:w-auto px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Assets"}),F.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:n,onChange:T,className:"w-full md:w-auto px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Blocks"}),I.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:x,onChange:E,className:"w-full md:w-auto px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:n?"All Rooms in This Block":"All Rooms"}),$.filter(t=>{var s;return!n||((s=t.block)==null?void 0:s.id)===Number(n)}).map(t=>e.jsxs("option",{value:t.id,children:[t.name,t.block&&` (${t.block.name})`]},t.id))]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[e.jsx(k,{type:"checkbox",checked:p,onChange:t=>O(t.target.checked),id:"details-mode",className:"w-4 h-4"}),e.jsxs("label",{htmlFor:"details-mode",className:"cursor-pointer select-none font-medium whitespace-nowrap",children:[p?"Detailed":"Summary"," Mode"]})]}),(h||n||x||o||A)&&e.jsx(u,{onClick:M,variant:"ghost",className:"w-full md:w-auto",children:"Clear Filters"})]}),e.jsx("div",{className:"overflow-x-auto space-y-3",children:m.data.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-10",children:"No assets found."}):e.jsxs("table",{className:"w-full min-w-[1000px] border-collapse rounded-lg overflow-hidden shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white",children:[e.jsx("th",{className:"border p-3 text-left",children:"Asset Name"}),p?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border p-3 text-left",children:"Category"}),e.jsx("th",{className:"border p-3 text-left",children:"Details"}),e.jsx("th",{className:"border p-3 text-center",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-left",children:"Added Date"}),e.jsx("th",{className:"border p-3 text-left",children:"Room / Block"}),e.jsx("th",{className:"border p-3 text-left",children:"Actions"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border p-3 text-center",children:"Total Quantity"}),e.jsx("th",{className:"border p-3 text-center",children:"Rooms"})]})]})}),e.jsx("tbody",{children:m.data.map((t,s)=>{var S;if(!p)return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:t.name}),e.jsx("td",{className:"border p-3 text-center text-lg font-bold text-green-600",children:t.total_qty}),e.jsx("td",{className:"border p-3 text-center text-amber-600",children:t.locations_count>0?e.jsx("a",{className:"hover:underline cursor-pointer font-semibold",onClick:H=>{H.preventDefault(),i.get("/institute-assets",{details:!0,asset:t.asset_id})},children:t.locations_count}):t.locations_count})]},`${t.name}-${s}`);if(!t.asset)return e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"border p-3 text-center text-muted-foreground",children:"Loading details..."})},s);const a=t;return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:a.asset.name}),e.jsx("td",{className:"border p-3",children:((S=a.asset.category)==null?void 0:S.name)||"—"}),e.jsx("td",{className:"border p-3 text-sm",children:a.details||"—"}),e.jsx("td",{className:"border p-3 text-center font-bold text-lg",children:a.current_qty}),e.jsx("td",{className:"border p-3 text-sm",children:new Date(a.added_date).toLocaleDateString()}),e.jsx("td",{className:"border p-3 text-sm",children:a.room?`${a.room.name}${a.room.block?` (${a.room.block.name})`:""}`:"—"}),e.jsx("td",{className:"border p-3",children:e.jsxs("div",{className:"flex gap-1",children:[(l==null?void 0:l.can_edit)&&e.jsx(D,{href:`/institute-assets/${a.id}/edit`,children:e.jsx(u,{variant:"ghost",size:"icon",children:e.jsx(J,{className:"h-4 w-4"})})}),(l==null?void 0:l.can_delete)&&e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsx(u,{variant:"ghost",size:"icon",className:"text-destructive",children:e.jsx(U,{className:"h-4 w-4"})})}),e.jsxs(te,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Delete Entry?"}),e.jsxs(le,{children:[e.jsx("strong",{children:a.asset.name})," (Qty: ",a.current_qty,") will be deleted."]})]}),e.jsxs(re,{children:[e.jsx(ne,{children:"Cancel"}),e.jsx(oe,{className:"bg-destructive",onClick:()=>z(a.id),children:"Delete"})]})]})]})]})})]},a.id)})})]})}),m.links.length>3&&e.jsx("div",{className:"flex justify-center gap-2 flex-wrap pt-6",children:m.links.map((t,s)=>e.jsx(u,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&i.visit(t.url,{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},s))})]})]})})]})}export{Se as default};
