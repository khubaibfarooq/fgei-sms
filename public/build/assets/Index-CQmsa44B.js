import{r as d,j as e,L as E,$ as S,S as j}from"./app-S7lYKvG0.js";import{A as q,P as O,S as z,a as H,T as M,t as A}from"./app-layout-Bve2dXhh.js";import{B as i}from"./button-BzZn1PjT.js";import{C as P,a as Q,b as K,c as V}from"./card-BF7MbLHo.js";import{I as D}from"./input-Y76x1Br-.js";import{A as G,a as J,b as U,c as W,d as X,e as Y,f as Z,g as ee,h as te}from"./alert-dialog-DTo1bdBl.js";import"./index-lQAedA_m.js";import"./createLucideIcon-DfsAraQl.js";import"./index-BhGuUI_l.js";import"./app-logo-icon-DiB2QrZ0.js";import"./folder-root-DXTs9AfZ.js";import"./grip-vertical-D3TFVv0e.js";const se=[{title:"Institute Assets",href:"/institute-assets"}];function je({instituteAssets:x,filters:c,blocks:g,rooms:w,categories:b,permissions:l}){const[h,f]=d.useState(c.search||""),[r,N]=d.useState(c.block||""),[m,p]=d.useState(c.room||""),[n,v]=d.useState(c.category||""),[u,y]=d.useState(c.details||!1),k=g?Object.entries(g).map(([t,s])=>({id:t,name:s})):[],_=b?Object.entries(b).map(([t,s])=>({id:t,name:s})):[],o=t=>{j.get("/institute-assets",{...c,...t},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters"]})},$=t=>{t.key==="Enter"&&o({search:h,category:n})},I=t=>{const s=t.target.value;N(s),p(""),o({block:s,room:"",category:n})},B=t=>{const s=t.target.value;p(s),o({room:s,category:n})},F=t=>{const s=t.target.value;v(s),o({block:r,room:m,category:s})},T=t=>{y(t),o({details:t,search:h,block:r,room:m,category:n})},L=()=>{f(""),N(""),p(""),v(""),y(!1),j.get("/institute-assets",{},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters"]})},R=t=>{j.delete(`/institute-assets/${t}`,{onSuccess:()=>A.success("Institute asset deleted successfully"),onError:()=>A.error("Failed to delete institute asset")})};return e.jsxs(q,{breadcrumbs:se,children:[e.jsx(E,{title:"Institute Asset Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(P,{children:[e.jsxs(Q,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-2xl font-bold",children:"Institute Assets"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institute asset inventory"})]}),(l==null?void 0:l.can_add)&&e.jsx(S,{href:"/institute-assets/create",children:e.jsxs(i,{children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]}),e.jsx(z,{}),e.jsxs(V,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-wrap items-center",children:[e.jsx(D,{placeholder:"Search assets... (press Enter)",value:h,onChange:t=>f(t.target.value),onKeyDown:$,className:"md:w-64"}),e.jsxs("select",{value:n,onChange:F,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),_.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:r,onChange:I,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Blocks"}),k.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:m,onChange:B,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:r?"All Rooms in This Block":"All Rooms"}),w.filter(t=>{var s;return!r||((s=t.block)==null?void 0:s.id)===Number(r)}).map(t=>e.jsxs("option",{value:t.id,children:[t.name,t.block&&` (${t.block.name})`]},t.id))]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{type:"checkbox",checked:u,onChange:t=>T(t.target.checked),id:"details-mode"}),e.jsxs("label",{htmlFor:"details-mode",className:"cursor-pointer select-none font-medium",children:[u?"Detailed View":"Summary View"," — Show Details"]})]}),(h||r||m||n)&&e.jsx(i,{onClick:L,variant:"ghost",children:"Clear Filters"})]}),e.jsx("div",{className:"overflow-x-auto",children:x.data.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-10",children:"No assets found."}):e.jsxs("table",{className:"w-full min-w-max border-collapse rounded-lg overflow-hidden shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white",children:[e.jsx("th",{className:"border p-3 text-left",children:"Asset Name"}),u?e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border p-3 text-left",children:"Category"}),e.jsx("th",{className:"border p-3 text-left",children:"Details"}),e.jsx("th",{className:"border p-3 text-center",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-left",children:"Added Date"}),e.jsx("th",{className:"border p-3 text-left",children:"Room / Block"}),e.jsx("th",{className:"border p-3 text-left",children:"Actions"})]}):e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"border p-3 text-center",children:"Total Quantity"}),e.jsx("th",{className:"border p-3 text-center",children:"Locations"})]})]})}),e.jsx("tbody",{children:x.data.map((t,s)=>{var C;if(!u)return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:t.name}),e.jsx("td",{className:"border p-3 text-center text-lg font-bold text-green-600",children:t.total_qty}),e.jsx("td",{className:"border p-3 text-center text-amber-600",children:t.locations_count})]},`${t.name}-${s}`);if(!t.asset)return e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"border p-3 text-center text-muted-foreground",children:"Loading details..."})},s);const a=t;return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:a.asset.name}),e.jsx("td",{className:"border p-3",children:((C=a.asset.category)==null?void 0:C.name)||"—"}),e.jsx("td",{className:"border p-3 text-sm",children:a.details||"—"}),e.jsx("td",{className:"border p-3 text-center font-bold text-lg",children:a.current_qty}),e.jsx("td",{className:"border p-3 text-sm",children:new Date(a.added_date).toLocaleDateString()}),e.jsx("td",{className:"border p-3 text-sm",children:a.room?`${a.room.name}${a.room.block?` (${a.room.block.name})`:""}`:"—"}),e.jsx("td",{className:"border p-3",children:e.jsxs("div",{className:"flex gap-1",children:[(l==null?void 0:l.can_edit)&&e.jsx(S,{href:`/institute-assets/${a.id}/edit`,children:e.jsx(i,{variant:"ghost",size:"icon",children:e.jsx(H,{className:"h-4 w-4"})})}),(l==null?void 0:l.can_delete)&&e.jsxs(G,{children:[e.jsx(J,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"text-destructive",children:e.jsx(M,{className:"h-4 w-4"})})}),e.jsxs(U,{children:[e.jsxs(W,{children:[e.jsx(X,{children:"Delete Entry?"}),e.jsxs(Y,{children:[e.jsx("strong",{children:a.asset.name})," (Qty: ",a.current_qty,") will be deleted."]})]}),e.jsxs(Z,{children:[e.jsx(ee,{children:"Cancel"}),e.jsx(te,{className:"bg-destructive",onClick:()=>R(a.id),children:"Delete"})]})]})]})]})})]},a.id)})})]})}),x.links.length>3&&e.jsx("div",{className:"flex justify-center gap-2 flex-wrap pt-6",children:x.links.map((t,s)=>e.jsx(i,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&j.visit(t.url,{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},s))})]})]})})]})}export{je as default};
