import{e as u,m as v,j as e,L as S,$ as N,S as p}from"./app-DBzhDjnR.js";import{A as w,S as _,a as y,d as B}from"./app-layout-BNAloD3B.js";import{B as x}from"./button-D_pD7jfh.js";import{C,a as A,b as E,c as L}from"./card-BHRl5sdy.js";import{I as o}from"./input-W0h1OP1_.js";import{L as d}from"./label-x9t_iHEI.js";import{S as F,a as b,b as U,c as D,d as R}from"./select-Dk9WhxeT.js";import"./index-DbQmxt2k.js";import"./createLucideIcon-bOA2hw3c.js";import"./index-CUAG3HMa.js";import"./index-DOIG-82r.js";import"./index-CvTI4rvu.js";import"./index-CCpTdKuy.js";import"./index-DB_qMx2A.js";import"./app-logo-icon-ys3Ztymg.js";import"./circle-x-nGrvtWG_.js";import"./clsx-B-dksMZM.js";import"./folder-root-BD5IpTYC.js";import"./grip-vertical-vsevKQ4A.js";import"./index-nv6te0VZ.js";import"./index-DwcGrrx3.js";function ae({block:s,blockTypes:l}){const a=!!s;console.log("blockTypes:",l);const c=u.useMemo(()=>l?Array.isArray(l)?l:Object.entries(l).map(([t,i])=>({id:parseInt(t),name:i})):[],[l]),{data:r,setData:m,processing:h,reset:f}=v({name:(s==null?void 0:s.name)||"",area:(s==null?void 0:s.area)||0,institute_id:(s==null?void 0:s.institute_id)||0,block_type_id:(s==null?void 0:s.block_type_id)||0,img:(s==null?void 0:s.img)||null,establish_date:(s==null?void 0:s.establish_date)||""}),j=t=>{t.preventDefault();const i=new FormData;Object.keys(r).forEach(n=>{if(!(r[n]===null||r[n]==="")){if(n==="img"){r[n]instanceof File&&i.append(n,r[n]);return}i.append(n,r[n])}}),a?(i.append("_method","PUT"),p.post(`/blocks/${s.id}`,i,{forceFormData:!0,preserveScroll:!0,preserveState:!0,onSuccess:()=>{p.get("/blocks")}})):p.post("/blocks",i,{onSuccess:()=>{f()}})},g=[{title:"Blocks",href:"/blocks"},{title:a?"Edit Block":"Add Block",href:"#"}];return e.jsxs(w,{breadcrumbs:g,children:[e.jsx(S,{title:a?"Edit Block":"Add Block"}),e.jsx("div",{className:"flex-1 p-4 md:p-6 w-full max-w-4xl mx-auto",children:e.jsxs(C,{children:[e.jsxs(A,{children:[e.jsx(E,{className:"text-2xl font-bold",children:a?"Edit Block":"Add Block"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a?"Edit block details":"Create a new block"})]}),e.jsx(_,{}),e.jsx(L,{className:"pt-6",children:e.jsxs("form",{onSubmit:j,className:"space-y-6",encType:"multipart/form-data",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"name",children:"Block Name"}),e.jsx(o,{id:"name",value:r.name,onChange:t=>m("name",t.target.value),placeholder:"Enter block name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"area",children:"Area (sq ft)"}),e.jsx(o,{id:"area",type:"number",value:r.area,onChange:t=>m("area",Number(t.target.value)),placeholder:"Enter area"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"block_type_id",children:"Block Type"}),e.jsxs(F,{value:r.block_type_id.toString(),onValueChange:t=>m("block_type_id",parseInt(t)),children:[e.jsx(b,{children:e.jsx(U,{placeholder:"Select block type"})}),e.jsx(D,{children:c.map(t=>e.jsx(R,{value:t.id.toString(),children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"establish_date",children:"Establish Date"}),e.jsx(o,{id:"establish_date",type:"date",value:r.establish_date||"",onChange:t=>m("establish_date",t.target.value),placeholder:"Select establish date"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"img",children:"Image"}),e.jsx(o,{id:"img",type:"file",accept:"image/*",onChange:t=>{var i;return m("img",((i=t.target.files)==null?void 0:i[0])||null)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{children:"Image Preview"}),e.jsx($,{dataImg:r.img})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 pt-6",children:[e.jsx(N,{href:"/blocks",className:"w-full sm:w-auto",children:e.jsxs(x,{type:"button",variant:"secondary",className:"w-full",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Back"]})}),e.jsxs(x,{type:"submit",disabled:h,className:"w-full sm:w-auto",children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),h?a?"Saving...":"Adding...":a?"Save Changes":"Add Block"]})]})]})})]})})]})}function $({dataImg:s}){const[l,a]=u.useState(()=>s&&typeof s=="string"?`/assets/${s}`:null);return u.useEffect(()=>{if(s instanceof File){const c=URL.createObjectURL(s);return a(c),()=>URL.revokeObjectURL(c)}else a(typeof s=="string"&&s?`/assets/${s}`:null)},[s]),l?e.jsx("img",{src:l,alt:"Layout",className:"w-full h-48 object-cover rounded"}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No image uploaded."})}export{ae as default};
