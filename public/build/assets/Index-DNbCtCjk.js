import{r as d,j as e,L as D,$ as f,S as l}from"./app-BfBsNhR2.js";import{A as I,g as _,e as T,S as E,f as F,T as L}from"./app-layout-BHrDjgaN.js";import{B as i}from"./button-DnXIKeMS.js";import{C as $,a as M,b as P,c as z}from"./card-C1zAWyXZ.js";import{I as H}from"./input-p6teb9xz.js";import{S as R,a as B,b as K,c as V,d as y}from"./select-DLeP13XF.js";import{A as q,a as O,b as U,c as G,d as J,e as Q,f as W,g as X,h as Y}from"./alert-dialog-BZa2VRRs.js";import{t as a}from"./index-DFHttNO2.js";import{L as Z}from"./app-logo-icon-B5PYNc1r.js";import"./index-CwTNOia7.js";import"./createLucideIcon-IOFs-Ga0.js";import"./index-BNHejynj.js";import"./index-D0ByLyEk.js";import"./index-TYwaR_GD.js";import"./index-CR8SgVfI.js";import"./circle-x-BJ_Uq_bA.js";import"./folder-root-DtoVYyZO.js";import"./grip-vertical-CzLPTgE7.js";import"./index-C14AzekR.js";import"./index-q2jedj5u.js";const ee=[{title:"Assets",href:"/asset"}];function ve({assets:c,assetCategories:N,filters:n}){const[x,b]=d.useState(n.search||""),[p,v]=d.useState(n.asset_category_id||""),[m,g]=d.useState(!1),o=d.useRef(null),C=s=>{l.delete(`/asset/${s}`,{onSuccess:()=>a.success("Asset deleted successfully"),onError:()=>a.error("Failed to delete asset")})},S=s=>{s.key==="Enter"&&l.get("/asset",{...n,search:x,asset_category_id:p},{preserveScroll:!0})},A=s=>{const r=s==="all"?"":s;v(r),l.get("/asset",{...n,search:x,asset_category_id:r},{preserveScroll:!0})},w=()=>{var s;(s=o.current)==null||s.click()},k=s=>{var u;const r=(u=s.target.files)==null?void 0:u[0];if(!r)return;if(o.current&&(o.current.value=""),!["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel"].includes(r.type)&&!r.name.match(/\.(xlsx|xls)$/)){a.error("Please select a valid Excel file (.xlsx or .xls)");return}g(!0),l.post("/asset/import",{file:r},{forceFormData:!0,onSuccess:h=>{var j;const t=h.props.flash;t!=null&&t.success&&a.success(t.success),t!=null&&t.error_count&&t.error_count>0&&a.warning(`${t.error_count} row(s) had errors and were skipped.`,{description:(j=t.import_errors)==null?void 0:j.join(`
`)}),t!=null&&t.error&&a.error(t.error)},onError:h=>{const t=Object.values(h).flat().join(`
`);a.error(t||"Failed to import assets. Please try again.")},onFinish:()=>{g(!1)}})};return e.jsxs(I,{breadcrumbs:ee,children:[e.jsx(D,{title:"Asset Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs($,{children:[e.jsxs(M,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(P,{className:"text-2xl font-bold",children:"Assets"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institutional assets"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",ref:o,onChange:k,accept:".xlsx,.xls",className:"hidden"}),e.jsxs(i,{variant:"outline",onClick:w,disabled:m,children:[m?e.jsx(Z,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(_,{className:"h-4 w-4 mr-2"}),m?"Importing...":"Import"]}),e.jsx(f,{href:"/asset/create",children:e.jsxs(i,{children:[e.jsx(T,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]})]}),e.jsx(E,{}),e.jsxs(z,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx(H,{type:"text",placeholder:"Search assets... (press Enter)",value:x,onChange:s=>b(s.target.value),onKeyDown:S,className:"md:w-1/2"}),e.jsxs(R,{value:p||"all",onValueChange:A,children:[e.jsx(B,{className:"md:w-1/4",children:e.jsx(K,{placeholder:"Filter by Category"})}),e.jsxs(V,{children:[e.jsx(y,{value:"all",children:"All Categories"}),N.map(s=>e.jsx(y,{value:String(s.id),children:s.name},s.id))]})]})]}),e.jsx("div",{className:"space-y-3",children:e.jsxs("table",{className:"w-full border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary dark:bg-gray-800",children:[e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Asset"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Type"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Category"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Details"}),e.jsx("th",{className:"border p-2 text-left text-sm font-medium text-white dark:text-gray-200",children:"Actions"})]})}),e.jsx("tbody",{children:c.data.length===0?e.jsx("p",{className:"text-muted-foreground text-center",children:"No assets found."}):c.data.map(s=>{var r;return e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",s.name]}),e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",s.type]}),e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",(r=s.category)==null?void 0:r.name]}),e.jsx("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:s.details}),e.jsxs("td",{className:"border p-2 text-sm text-gray-900 dark:text-gray-100",children:[" ",e.jsx(f,{href:`/asset/${s.id}/edit`,children:e.jsx(i,{variant:"ghost",size:"icon",children:e.jsx(F,{className:"h-4 w-4"})})}),e.jsxs(q,{children:[e.jsx(O,{asChild:!0,children:e.jsx(i,{variant:"ghost",size:"icon",className:"text-destructive hover:text-red-600",children:e.jsx(L,{className:"h-4 w-4"})})}),e.jsxs(U,{children:[e.jsxs(G,{children:[e.jsx(J,{children:"Delete this asset?"}),e.jsxs(Q,{children:["Asset ",e.jsx("strong",{children:s.name})," will be permanently deleted."]})]}),e.jsxs(W,{children:[e.jsx(X,{children:"Cancel"}),e.jsx(Y,{className:"bg-destructive hover:bg-destructive/90",onClick:()=>C(s.id),children:"Delete"})]})]})]})]})]},s.id)})})]})}),c.links.length>1&&e.jsx("div",{className:"flex justify-center pt-6 flex-wrap gap-2",children:c.links.map((s,r)=>e.jsx(i,{disabled:!s.url,variant:s.active?"default":"outline",size:"sm",onClick:()=>l.visit(s.url||"",{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:s.label}})},r))})]})]})})]})}export{ve as default};
