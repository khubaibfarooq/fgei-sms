import{K as R,r as n,j as e,L as V,S as k,a as L}from"./app-ClCe4XWD.js";import{A as I}from"./app-layout-C05Ffiuj.js";import{C as x,c as p,a as g,b as f}from"./card-iqLTVnFW.js";import{D as W,a as X,b as q,c as z,d as G,t as J}from"./index-LG7pQxCR.js";import{FundsPieChart as $,InstituteDonutChart as A,DistributionPieChart as Q,ProjectsCostChart as T,ProjectsCountChart as Y,RegionalFundsChart as Z,TaskStatusChart as ee,AssetsBarChart as te}from"./DashboardCharts-B5Ee5krM.js";import{C as se,a as M}from"./circle-x-BMGwx3SN.js";import"./button-BABP4Bhb.js";import"./clsx-B-dksMZM.js";import"./index-BxLee3OG.js";import"./createLucideIcon-CKSNDXsJ.js";import"./index-DfsfDBTN.js";import"./index-BXBaJBKB.js";import"./index-B6HXnpRV.js";import"./index-BZFkytb9.js";import"./input--vgU5unm.js";import"./app-logo-icon-DF4Mufrr.js";import"./folder-root-CGcl8OM_.js";import"./grip-vertical-on6EWWBN.js";import"./PieChart-D6wOqijF.js";import"./index-CWqkZ5l-.js";const ae=[{title:"Dashboard",href:"/dashboard"}],P=[{label:"Users",value:420,color:"#3b82f6",redirectlink:""},{label:"Backups",value:80,color:"#10b981",redirectlink:""},{label:"Activity Logs",value:1570,color:"#f59e0b",redirectlink:""}],K=[{bg:"from-blue-50 to-blue-100 dark:from-blue-950/20 dark:to-blue-900/30",border:"border-blue-200",header:"bg-blue-500",text:"text-blue-800 dark:text-blue-200",accent:"bg-blue-200/50"},{bg:"from-green-50 to-green-100 dark:from-blue-950/20 dark:to-blue-900/30",border:"border-green-200",header:"bg-green-500",text:"text-green-800 dark:text-green-200",accent:"bg-green-200/50"},{bg:"from-amber-50 to-amber-100 dark:from-blue-950/20 dark:to-blue-900/30",border:"border-amber-200",header:"bg-amber-500",text:"text-amber-800 dark:text-amber-200",accent:"bg-amber-200/50"}],re=t=>t.split("_").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "),C=t=>!t||t.length===0?[]:Object.keys(t[0]),le=(t,o,j,b)=>{if(t==null)return"-";const h=["balance","cost","amount","price","value","total_cost","total_amount","estimated_cost","actual_cost"].some(c=>o==null?void 0:o.toLowerCase().includes(c));if(typeof t=="number")return h&&t>=1e6?`${(t/1e6).toFixed(2)} Mn`:t.toLocaleString();if(typeof t=="string"){if(h){const c=parseFloat(t);if(!isNaN(c))return c>=1e6?`${(c/1e6).toFixed(2)} Mn`:`${c.toLocaleString()}`}return j===1&&b!=="Funds"&&b!=="Total Funds"?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():t}return String(t)};function De(){var D;const{props:t}=R();t.auth.user;const o=t.cards||[],[j,b]=n.useState(P),[y,h]=n.useState(!1),[c,oe]=n.useState({}),[u,v]=n.useState({0:5,1:5,2:5}),[_,N]=n.useState(!1),[d,w]=n.useState(null),[O,S]=n.useState(!1),U=async(s,a)=>{if(s&&s.includes("/dashboard/completion")){S(!0),N(!0),w(null);try{const r=await L.get(s);w(r.data)}catch(r){console.error(r),J.error("Failed to load details"),N(!1)}finally{S(!1)}}else s&&k.visit(s)},B=[{title:t.title1||"Funds",data:t.tab1||[],columns:C(t.tab1||[]),link:t.link1||""},{title:t.title2||"Tab2",data:t.tab2||[],columns:C(t.tab2||[]),link:t.link2||""},{title:t.title3||"Tab3",data:t.tab3||[],columns:C(t.tab3||[]),link:t.link3||""}];n.useEffect(()=>{if(o.length===0)return;(async()=>{h(!0);try{const a=o.map(async l=>{try{const i=await L.get(l.link);return{label:l.title,value:i.data.count||0,color:l.color,redirectlink:l.redirectlink}}catch(i){return console.error(`Failed to fetch count for ${l.title}:`,i),{label:l.title,value:0,color:l.color,redirectlink:l.redirectlink}}}),r=await Promise.all(a);b(r)}catch(a){console.error("Failed to fetch summary data:",a)}finally{h(!1)}})()},[o]);const E=s=>{v(a=>({...a,[s]:(a[s]||5)+5}))},H=s=>{v(a=>({...a,[s]:Math.max(5,(a[s]||5)-5)}))};return e.jsxs(I,{breadcrumbs:ae,children:[e.jsx(V,{title:"Dashboard"}),e.jsxs("div",{className:"flex flex-col gap-2 md:gap-6 sm:gap-4 p-2 md:p-5",children:[e.jsx("div",{className:"relative px-2 sm:px-8 py-2 sm:py-6 text-center",children:e.jsx(x,{className:"inline-block bg-primary/95 backdrop-blur-sm shadow-2xl border-0 max-w-3xl mx-auto mb-2 p-2 md:p-5",style:{borderBottom:"6px solid rgba(0,0,255,0.7)"},children:e.jsx(p,{className:" pt-2 px-2 sm:pt-5 sm:px-10",children:e.jsx("h1",{className:"text-md sm:text-xl  md:text-4xl sm:font-bold font-semibold text-white",children:"School Management System"})})})}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2 md:gap-4 lg:gap-6",children:(y?P:j).map((s,a)=>{var i;const r=o[a],l=(r==null?void 0:r.icon)||["Users","HardDrive","LogIcon"][a%3];return e.jsx("div",{onClick:()=>{var m;(m=s.redirectlink)!=null&&m.includes("/dashboard/completion")?U(s.redirectlink):s.redirectlink&&k.visit(s.redirectlink)},className:s.redirectlink?"cursor-pointer":"",children:e.jsx(x,{redirectLink:(i=s.redirectlink)!=null&&i.includes("/dashboard/completion")?void 0:s.redirectlink,number:y?"...":s.label==="Funds"||s.label==="Institutes Funds"||s.label==="Total Funds"?`${(s.value/1e6).toFixed(2)}Mn`:s.value,title:s.label,icon:l,iconBgColor:s.color,changeColorOnHover:!0,className:"shadow-lg p-2 md:p-5 hover:scale-110 hover:-translate-y-2 transition-all duration-300 ease-in-out active:scale-95"})},a)})}),e.jsxs("div",{className:"mb-1 md:mb-2",children:[e.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-4 px-1",children:"Analytics Overview"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2 md:gap-4",children:[e.jsxs(x,{className:"shadow-lg p-1 sm:p-2",children:[e.jsx(g,{className:"pb-1 md:pb-2",children:e.jsxs(f,{className:"text-lg font-medium text-gray-700 dark:text-gray-200",children:[t.title1," Analysis"]})}),e.jsx(p,{className:"h-[200px] sm:h-[250px] md:h-[300px] pt-4",children:t.title1==="Funds"?e.jsx($,{data:t.tab1}):t.title1==="Institutes"?e.jsx(A,{data:t.tab1}):t.title1==="Total Funds"?e.jsx($,{data:t.tab1}):t.title1==="Users"?e.jsx(Q,{data:t.tab1,nameKey:"type",valueKey:"user_count"}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No Chart Available"})})]}),e.jsxs(x,{className:"shadow-lg p-1 sm:p-2",children:[e.jsx(g,{className:"pb-1 md:pb-2",children:e.jsxs(f,{className:"text-lg font-medium text-gray-700 dark:text-gray-200",children:[t.title2," Analysis"]})}),e.jsx(p,{className:"h-[200px] sm:h-[250px] md:h-[300px] pt-4",children:t.title2==="Projects"?((D=t.tab2[0])==null?void 0:D.estimated_cost)!==void 0?e.jsx(T,{data:t.tab2}):e.jsx(Y,{data:t.tab2}):t.title2==="Funds"?e.jsx(Z,{data:t.tab2}):t.title2==="Tasks"?e.jsx(ee,{data:t.tab2}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No Chart Available"})})]}),t.title3&&e.jsxs(x,{className:"shadow-lg p-1 sm:p-2",children:[e.jsx(g,{className:"pb-1 md:pb-2",children:e.jsxs(f,{className:"text-lg font-medium text-gray-700 dark:text-gray-200",children:[t.title3," Analysis"]})}),e.jsx(p,{className:"h-[200px] sm:h-[250px] md:h-[300px] pt-4",children:t.title3==="Assets"?e.jsx(te,{data:t.tab3}):t.title3==="Projects"?e.jsx(T,{data:t.tab3}):t.title3==="Institutions"?e.jsx(A,{data:t.tab3}):e.jsx("div",{className:"flex items-center justify-center h-full text-gray-400",children:"No Chart Available"})})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 md:gap-4",children:B.map((s,a)=>{const r=K[a%K.length];return e.jsxs(x,{className:`bg-gradient-to-br ${r.bg} ${r.border} shadow-lg rounded-xl overflow-hidden dark:bg-gray-800 dark:border-gray-700`,children:[e.jsx(g,{className:`${r.header} text-white px-6 py-2 dark:bg-gray-700`,children:e.jsxs(f,{className:"text-lg font-semibold flex items-center",children:[e.jsx("span",{className:"w-3 h-3 bg-white rounded-full mr-2"}),s.title]})}),e.jsx(p,{className:"p-0",children:s.data.length>0?e.jsxs("div",{className:"overflow-x-auto  py-3",children:[e.jsx("div",{className:"shadow-sm rounded-md overflow-hidden",children:e.jsxs("table",{className:"w-full table-fixed",children:[e.jsx("thead",{className:`${r.accent} dark:bg-gray-600`,children:e.jsx("tr",{children:s.columns.map((l,i)=>l!=="Key"&&e.jsx("th",{className:"text-left py-3 px-4 text-sm md:text-lg font-semibold dark:text-gray-200",style:{color:r.header.replace("bg-","text-")+"900"},children:re(l)},i))})}),e.jsx("tbody",{children:s.data.slice(0,u[a]||5).map((l,i)=>e.jsx("tr",{onClick:()=>{l.Key&&s.link&&k.visit(`${s.link}${l.Key}`)},className:`border-b ${s.link?"cursor-pointer":""} ${r.border}/30 transition-all hover:opacity-95 hover:shadow-md
                          ${i%2===0?"bg-white dark:bg-gray-800":"bg-gray-50 dark:bg-gray-700"}`,children:s.columns.map((m,F)=>m!=="Key"&&e.jsx("td",{className:`py-3 px-4 text-sm md:text-lg ${r.text}`,children:le(l[m],m,F,s.title)},F))},i))})]})}),s.data.length>5&&e.jsxs("div",{className:"p-4 dark:bg-blue-950/20 text-center border-t border-gray-200 bg-gray-50 flex gap-2 justify-center",children:[(u[a]||5)<s.data.length&&e.jsxs("button",{type:"button",onClick:()=>E(a),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border border-transparent bg-blue-500 dark:bg-blue-950 text-white shadow-sm hover:bg-blue-600 focus:outline-none transition-colors",children:["Show More (",s.data.length-(u[a]||5)," remaining)"]}),(u[a]||5)>5&&e.jsx("button",{type:"button",onClick:()=>H(a),className:"inline-flex items-center px-4 py-2 text-sm font-medium rounded-md border border-transparent bg-gray-400 text-white shadow-sm hover:bg-gray-500 focus:outline-none transition-colors",children:"Show Less"})]})]}):e.jsx("div",{className:"py-8 text-center text-gray-500 dark:text-gray-400",children:"No data available"})})]},a)})}),e.jsx(W,{open:_,onOpenChange:N,children:e.jsxs(X,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(q,{children:[e.jsxs(z,{className:"text-xl",children:["Completion Details: ",(d==null?void 0:d.institute)||"Loading..."]}),e.jsx(G,{children:"Detailed breakdown of invalid or missing criteria."})]}),O?e.jsx("div",{className:"flex justify-center p-8",children:"Loading details..."}):d?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[e.jsx("span",{className:"font-semibold text-lg",children:"Total Score"}),e.jsxs("span",{className:`text-2xl font-bold ${d.percentage===100?"text-green-600":d.percentage<50?"text-red-600":"text-yellow-600"}`,children:[d.percentage,"%"]})]}),e.jsx("div",{className:"rounded-md border",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-muted/50 text-muted-foreground uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left",children:"Criteria"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Weight"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left",children:"Message"})]})}),e.jsx("tbody",{className:"divide-y",children:d.criteria.map((s,a)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:s.name}),e.jsxs("td",{className:"px-4 py-3 text-right text-muted-foreground",children:[s.weight,"%"]}),e.jsx("td",{className:"px-4 py-3 text-center",children:s.completed?e.jsx(se,{className:"w-5 h-5 text-green-500 mx-auto"}):e.jsx(M,{className:"w-5 h-5 text-red-500 mx-auto"})}),e.jsx("td",{className:`px-4 py-3 ${s.completed?"text-green-600":"text-red-600"}`,children:s.message})]},a))})]})}),d.percentage<100&&e.jsxs("div",{className:"text-sm text-muted-foreground bg-blue-50 p-3 rounded border border-blue-100 dark:bg-blue-900/20 dark:border-blue-900",children:["Note: Please address the items marked with ",e.jsx(M,{className:"w-3 h-3 inline text-red-500"})," to reach 100% completion."]})]}):e.jsx("div",{className:"text-center text-red-500",children:"Failed to load details."})]})})]})]})}export{De as default};
