import{m as k,j as e,L as w,$ as y}from"./app-CojgiVch.js";import{B as h}from"./button-IquJX4WN.js";import{I as R}from"./input-DrKt9JVg.js";import{L as E}from"./label-BXlRyqbs.js";import{C as u}from"./checkbox-BIZctTLb.js";import{A as S,S as c}from"./app-layout-DXSH12Rt.js";import{C as $,a as L,b as F,c as P}from"./card-CodeGcKQ.js";import"./index-DNVGzEEd.js";import"./index-BmxgWB5O.js";import"./index-CZ8QT4XQ.js";import"./createLucideIcon-2pOlm87_.js";import"./index-CEQqBRRX.js";import"./index-DARK02K5.js";import"./index-DioUGrqf.js";import"./index-pyCx4HTh.js";import"./app-logo-icon-BBattvAk.js";import"./circle-x-BgsyBBY9.js";import"./folder-root-rA_tu2I5.js";import"./grip-vertical-Cxn8M8ev.js";function Z({role:i,groupedPermissions:j}){var p;const r=!!i,{data:t,setData:m,post:f,put:g,processing:d,errors:o}=k({name:(i==null?void 0:i.name)||"",permissions:((p=i==null?void 0:i.permissions)==null?void 0:p.map(s=>s.name))||[]}),N=s=>{s.preventDefault(),r?g(`/roles/${i==null?void 0:i.id}`):f("/roles")},C=[{title:"Role Management",href:"/roles"},{title:r?"Edit Role":"Create Role",href:"#"}],b=s=>{m("permissions",t.permissions.includes(s)?t.permissions.filter(n=>n!==s):[...t.permissions,s])},v=(s,n)=>{if(n.every(a=>t.permissions.includes(a.name)))m("permissions",t.permissions.filter(a=>!n.map(l=>l.name).includes(a)));else{const a=[...t.permissions];n.forEach(l=>{a.includes(l.name)||a.push(l.name)}),m("permissions",a)}};return e.jsxs(S,{breadcrumbs:C,children:[e.jsx(w,{title:r?"Edit Role":"Create Role"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs($,{className:"max-w-4xl mx-auto",children:[e.jsxs(L,{className:"pb-3",children:[e.jsx(F,{className:"text-2xl font-bold tracking-tight",children:r?"Edit Role":"Create New Role"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:r?"Update role details and permissions":"Create a new role and set permissions"})]}),e.jsx(c,{}),e.jsx(P,{className:"pt-5",children:e.jsxs("form",{onSubmit:N,className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(E,{htmlFor:"name",className:"mb-2 block",children:"Role Name"}),e.jsx(R,{id:"name",placeholder:"Enter role name",value:t.name,onChange:s=>m("name",s.target.value),className:o.name?"border-red-500":""}),o.name&&e.jsx("p",{className:"text-sm text-red-500 mt-2",children:o.name})]}),e.jsx(c,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Permissions"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Select permissions to grant to this role"})]}),e.jsx("div",{className:"space-y-4",children:Object.entries(j).map(([s,n])=>{const x=n.every(a=>t.permissions.includes(a.name));return e.jsxs("div",{className:"bg-muted/20 p-4 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(u,{id:`group-${s}`,checked:x,onCheckedChange:()=>v(s,n)}),e.jsx("label",{htmlFor:`group-${s}`,className:"text-sm font-medium uppercase tracking-wider text-muted-foreground cursor-pointer",children:s})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 pl-7",children:n.map(a=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(u,{id:`perm-${a.id}`,checked:t.permissions.includes(a.name),onCheckedChange:()=>b(a.name)}),e.jsx("label",{htmlFor:`perm-${a.id}`,className:"text-sm cursor-pointer",children:a.name})]},a.id))})]},s)})})]})]}),e.jsx(c,{}),e.jsxs("div",{className:"flex flex-col-reverse sm:flex-row justify-end gap-3 pt-2",children:[e.jsx(y,{href:"/roles",className:"w-full sm:w-auto",children:e.jsx(h,{type:"button",variant:"secondary",className:"w-full",children:"Cancel"})}),e.jsx(h,{type:"submit",disabled:d,className:"w-full sm:w-auto",children:d?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animate-spin",children:"â†»"}),"Saving..."]}):r?"Save Changes":"Create Role"})]})]})})]})})]})}export{Z as default};
