import{r as u,j as e,L as O,$ as j,S as N}from"./app-DVmN6rxl.js";import{A as z,d as B,e as S,S as H,aO as K,f as R,T as q}from"./app-layout-CGHmoPsR.js";import{B as l}from"./button-Y1YC9s4b.js";import{u as G,a as b,D,c as C,S as w,v as y,b as M,d as J,K as Q,P as U}from"./SortableMenuItem-lLPTiJmj.js";import{C as V,a as W,b as X,c as Y}from"./card-CCl5I7tz.js";import{A as Z,a as _,b as ee,c as se,d as re,e as te,f as ne,g as ie,h as ae}from"./alert-dialog-B-d2v0gp.js";import{t as m}from"./index-BQ0bSucX.js";import{a as de}from"./index-CpqM-Iiz.js";import"./index-BB5L8rS7.js";import"./createLucideIcon-CRhMnQ-_.js";import"./index-CGEHoyjy.js";import"./index-Xs4jzNsd.js";import"./index-CLBkeE6e.js";import"./input-DPpOm_0X.js";import"./app-logo-icon-ByOdZxav.js";import"./circle-x-N0dkq0YT.js";import"./clsx-B-dksMZM.js";import"./grip-vertical-LS8DZRX_.js";import"./folder-root-DlWqQeoD.js";const le=[{title:"Menu Management",href:"/menus"}];function Ae({menuItems:A}){const[d,h]=u.useState(A),[p,f]=u.useState(!1),[I,E]=u.useState([]),g=G(b(U),b(Q)),T=t=>{E(i=>i.includes(t)?i.filter(r=>r!==t):[...i,t])},k=t=>{const{active:i,over:r}=t;if(!r||i.id===r.id)return;const s=d.findIndex(n=>n.id===Number(i.id)),a=d.findIndex(n=>n.id===Number(r.id));h(n=>M(n,s,a))},F=t=>i=>{const{active:r,over:s}=i;!s||r.id===s.id||h(a=>a.map(n=>{if(n.id!==t||!n.children)return n;const o=n.children.findIndex(x=>x.id===Number(r.id)),c=n.children.findIndex(x=>x.id===Number(s.id));if(o===-1||c===-1)return n;const $=M(n.children,o,c);return{...n,children:$}}))},L=()=>{f(!0);const t=i=>i.map((r,s)=>({id:r.id,order:s+1,children:r.children?t(r.children):[]}));N.post("/menus/reorder",{menus:t(d)},{onSuccess:()=>m.success("Menu order saved successfully"),onError:()=>m.error("Failed to save menu order"),onFinish:()=>f(!1)})},P=t=>{N.delete(`/menus/${t}`,{onSuccess:()=>{h(i=>i.map(r=>{var s;return{...r,children:((s=r.children)==null?void 0:s.filter(a=>a.id!==t))||[]}}).filter(r=>r.id!==t)),m.success("Menu deleted successfully.")},onError:()=>m.error("Failed to delete menu.")})};function v(t,i=0){const r=["ml-0","ml-4","ml-8","ml-12","ml-16","ml-20"];return t.map(s=>{const a=s.children&&s.children.length>0,n=I.includes(s.id),o=r[i]||"ml-20";return e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center justify-between rounded-lg border bg-background px-4 py-3 shadow-sm hover:shadow transition-shadow ${o}`,children:[e.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[a?e.jsx("button",{onClick:()=>T(s.id),className:"text-muted-foreground hover:text-primary transition",children:n?e.jsx(de,{className:"h-4 w-4"}):e.jsx(K,{className:"h-4 w-4"})}):e.jsx("span",{className:"w-4"}),e.jsx(J,{id:s.id.toString(),title:s.title})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(j,{href:`/menus/${s.id}/edit`,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-primary",children:e.jsx(R,{className:"h-4 w-4"})})}),e.jsxs(Z,{children:[e.jsx(_,{asChild:!0,children:e.jsx(l,{variant:"ghost",size:"icon",className:"text-muted-foreground hover:text-destructive",children:e.jsx(q,{className:"h-4 w-4"})})}),e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(re,{children:"Delete this menu?"}),e.jsxs(te,{children:['This will permanently delete the menu "',s.title,'".']})]}),e.jsxs(ne,{children:[e.jsx(ie,{children:"Cancel"}),e.jsx(ae,{onClick:()=>P(s.id),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]})]}),a&&n&&e.jsx("div",{className:"mt-1",children:e.jsx(D,{sensors:g,collisionDetection:C,onDragEnd:F(s.id),children:e.jsx(w,{items:s.children.map(c=>c.id.toString()),strategy:y,children:v(s.children,i+1)})})})]},s.id)})}return e.jsxs(z,{breadcrumbs:le,children:[e.jsx(O,{title:"Menu Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(V,{className:"w-full",children:[e.jsx(W,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(X,{className:"text-2xl font-bold tracking-tight",children:"Menu Management"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag & drop to reorder main menus and submenus"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l,{onClick:L,disabled:p,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),p?"Saving...":"Save Order"]}),e.jsx(j,{href:"/menus/create",children:e.jsxs(l,{children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Add Menu"]})})]})]})}),e.jsx(H,{}),e.jsx(Y,{className:"pt-6",children:d.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"No menus available"}),e.jsx(j,{href:"/menus/create",children:e.jsxs(l,{children:[e.jsx(S,{className:"mr-2 h-4 w-4"}),"Add First Menu"]})})]}):e.jsx("div",{className:"space-y-4",children:e.jsx(D,{sensors:g,collisionDetection:C,onDragEnd:k,children:e.jsx(w,{items:d.map(t=>t.id.toString()),strategy:y,children:e.jsx("div",{className:"space-y-3",children:v(d)})})})})})]})})]})}export{Ae as default};
