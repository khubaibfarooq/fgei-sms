import{r as f,j as e,L as C,$ as N,S as o}from"./app-C_vGv3Mn.js";import{A as y,a as b,d as q}from"./app-layout-C3DK89xl.js";import{B as p}from"./button-D3ICZUlX.js";import{C as L,a as k,b as A,c as E}from"./card-D4hKHGA3.js";import{I as m}from"./input-Dh2IztUZ.js";import{L as l}from"./label-DZZSVEoq.js";import{T as F}from"./textarea-BfOnAr29.js";import{C as n}from"./checkbox-Dz5cYHEY.js";import{S as w,a as I,b as D,c as T,d as u}from"./select-BJlDp5Vp.js";import{t as x}from"./index-B7RycKoC.js";import{M as g}from"./MultiSelect-D_9VxPqk.js";import"./index-C4ULTFvu.js";import"./createLucideIcon-N4voy0hI.js";import"./index-B6M9QBmr.js";import"./index-iuOc_lCk.js";import"./index-Y6ZT9tnY.js";import"./index-DIjeUE5K.js";import"./app-logo-icon-D2bEHVg5.js";import"./circle-x-DVldkpcR.js";import"./folder-root-pqswtxXi.js";import"./grip-vertical-BFFqqoG4.js";import"./index-BAR51-c9.js";import"./index-BlEnD_H_.js";function le({stage:s,fundHeads:h,users:j}){var c,d;const t=!!s,[a,i]=f.useState({stage_name:(s==null?void 0:s.stage_name)||"",fund_head_id:((c=s==null?void 0:s.fund_head_id)==null?void 0:c.toString())||"",stage_order:((d=s==null?void 0:s.stage_order)==null?void 0:d.toString())||"",description:(s==null?void 0:s.description)||"",is_mandatory:(s==null?void 0:s.is_mandatory)??!0,users_can_approve:(s==null?void 0:s.users_can_approve)||[],is_last:(s==null?void 0:s.is_last)??!1,level:(s==null?void 0:s.level)||"",is_user_required:(s==null?void 0:s.is_user_required)??!1}),v=r=>{r.preventDefault(),t?o.put(`/approval-stages/${s.id}`,a,{onSuccess:()=>x.success("Stage updated successfully")}):o.post("/approval-stages",a,{onSuccess:()=>x.success("Stage created successfully")})},_=[{title:"Approval Stages",href:"/approval-stages"},{title:t?"Edit Stage":"Create Stage",href:"#"}];return e.jsxs(y,{breadcrumbs:_,children:[e.jsx(C,{title:t?"Edit Stage":"Create Stage"}),e.jsx("div",{className:"flex-1 p-4 md:p-6 w-full mx-auto",children:e.jsxs(L,{children:[e.jsx(k,{children:e.jsx(A,{children:t?"Edit Approval Stage":"Define New Stage"})}),e.jsx(E,{children:e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{children:["Stage Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{value:a.stage_name,onChange:r=>i({...a,stage_name:r.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Fund Head (Categorical)"}),e.jsxs(w,{value:a.fund_head_id,onValueChange:r=>i({...a,fund_head_id:r}),children:[e.jsx(I,{children:e.jsx(D,{placeholder:"Select Fund Head (Optional)"})}),e.jsxs(T,{children:[e.jsx(u,{value:"0",children:"Global (No specific Fund Head)"}),h.map(r=>e.jsx(u,{value:r.id.toString(),children:r.name},r.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(l,{children:["Stage Order (Sequence) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(m,{type:"number",value:a.stage_order,onChange:r=>i({...a,stage_order:r.target.value}),required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Description"}),e.jsx(F,{value:a.description,onChange:r=>i({...a,description:r.target.value})})]}),e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{id:"mandatory",checked:a.is_mandatory,onCheckedChange:r=>i({...a,is_mandatory:!!r})}),e.jsx(l,{htmlFor:"mandatory",children:"Mandatory Stage?"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{id:"is_user_required",checked:a.is_user_required,onCheckedChange:r=>i({...a,is_user_required:!!r})}),e.jsx(l,{htmlFor:"is_user_required",children:"User Selection Req?"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{id:"is_last",checked:a.is_last,onCheckedChange:r=>i({...a,is_last:!!r})}),e.jsx(l,{htmlFor:"is_last",children:"Is Last Stage?"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{children:"Approvers (Users)"}),e.jsx(g,{options:j.map(r=>({value:r.id.toString(),label:r.name})),value:(a.users_can_approve||[]).map(r=>r.toString()),onChange:r=>i({...a,users_can_approve:r.map(S=>parseInt(S))}),placeholder:"Select Approvers..."})]}),e.jsx("div",{className:"flex items-center space-x-2"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{children:"Level"}),e.jsxs("select",{value:a.level,onChange:r=>i({...a,level:r.target.value}),required:!0,children:[e.jsx("option",{value:"",children:"Select Level"}),e.jsx("option",{value:"institutional",children:"Institutional"}),e.jsx("option",{value:"regional",children:"Regional"}),e.jsx("option",{value:"dte",children:"DTE"})]})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx(N,{href:"/approval-stages",children:e.jsxs(p,{variant:"outline",type:"button",children:[e.jsx(b,{className:"w-4 h-4 mr-2"})," Back"]})}),e.jsxs(p,{type:"submit",children:[e.jsx(q,{className:"w-4 h-4 mr-2"})," Save Stage"]})]})]})})]})})]})}export{le as default};
