import{r as i,j as e,L as $,$ as v,S as x}from"./app-DP9dkHX6.js";import{A as B,P as R,S as T,a as E,T as F,t as N}from"./app-layout-Bjqdg_aF.js";import{B as n}from"./button-D9YN_eAK.js";import{C as L,a as O,b as q,c as z}from"./card-BVe_l3G1.js";import{I as H}from"./input-D2cWxQ17.js";import{A as M,a as P,b as K,c as Q,d as G,e as J,f as U,g as V,h as W}from"./alert-dialog-Hfu8xUFn.js";import"./index-UKHHs9Zt.js";import"./createLucideIcon-BDpQS6v7.js";import"./index-Dlmi4Jgv.js";import"./app-logo-icon-CN-McaLz.js";import"./folder-root-CeDQ0Pc3.js";import"./grip-vertical-r4wb2W3f.js";const X=[{title:"Institute Assets",href:"/institute-assets"}];function ie({instituteAssets:o,filters:r,blocks:j,rooms:y,categories:p,permissions:a}){const[h,g]=i.useState(r.search||""),[l,f]=i.useState(r.block||""),[u,m]=i.useState(r.room||""),[c,b]=i.useState(r.category||""),A=j?Object.entries(j).map(([t,s])=>({id:t,name:s})):[],C=p?Object.entries(p).map(([t,s])=>({id:t,name:s})):[],d=t=>{x.get("/institute-assets",{...r,...t},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters"]})},S=t=>{t.key==="Enter"&&d({search:h,category:c})},w=t=>{const s=t.target.value;f(s),m(""),d({block:s,room:"",category:c})},D=t=>{const s=t.target.value;m(s),d({room:s,category:c})},k=t=>{const s=t.target.value;b(s),d({block:l,room:u,category:s})},I=()=>{g(""),f(""),m(""),b(""),x.get("/institute-assets",{},{preserveScroll:!0,preserveState:!0,replace:!0,only:["instituteAssets","filters"]})},_=t=>{x.delete(`/institute-assets/${t}`,{onSuccess:()=>N.success("Institute asset deleted successfully"),onError:()=>N.error("Failed to delete institute asset")})};return e.jsxs(B,{breadcrumbs:X,children:[e.jsx($,{title:"Institute Asset Management"}),e.jsx("div",{className:"flex-1 p-4 md:p-6",children:e.jsxs(L,{children:[e.jsxs(O,{className:"pb-3 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{className:"text-2xl font-bold",children:"Institute Assets"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Manage institute asset inventory"})]}),(a==null?void 0:a.can_add)&&e.jsx(v,{href:"/institute-assets/create",children:e.jsxs(n,{children:[e.jsx(R,{className:"h-4 w-4 mr-2"}),"Add Asset"]})})]}),e.jsx(T,{}),e.jsxs(z,{className:"pt-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 flex-wrap items-center",children:[e.jsx(H,{placeholder:"Search assets... (press Enter)",value:h,onChange:t=>g(t.target.value),onKeyDown:S,className:"md:w-64"}),e.jsxs("select",{value:c,onChange:k,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Categories"}),C.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:l,onChange:w,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Blocks"}),A.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]}),e.jsxs("select",{value:u,onChange:D,className:"px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:l?"All Rooms in This Block":"All Rooms"}),y.filter(t=>{var s;return!l||((s=t.block)==null?void 0:s.id)===Number(l)}).map(t=>e.jsxs("option",{value:t.id,children:[t.name,t.block&&` (${t.block.name})`]},t.id))]}),(h||l||u||c)&&e.jsx(n,{onClick:I,variant:"ghost",children:"Clear Filters"})]}),e.jsx("div",{className:"overflow-x-auto",children:o.data.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-10",children:"No institute assets found."}):e.jsxs("table",{className:"w-full min-w-max border-collapse rounded-lg overflow-hidden shadow-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-primary text-white",children:[e.jsx("th",{className:"border p-3 text-left",children:"Asset"}),e.jsx("th",{className:"border p-3 text-left",children:"Category"}),e.jsx("th",{className:"border p-3 text-left",children:"Details"}),e.jsx("th",{className:"border p-3 text-center",children:"Quantity"}),e.jsx("th",{className:"border p-3 text-left",children:"Added Date"}),e.jsx("th",{className:"border p-3 text-left",children:"Room"}),e.jsx("th",{className:"border p-3 text-left",children:"Actions"})]})}),e.jsx("tbody",{children:o.data.map(t=>{var s;return e.jsxs("tr",{className:"hover:bg-muted/50",children:[e.jsx("td",{className:"border p-3 font-semibold",children:t.asset.name}),e.jsx("td",{className:"border p-3",children:((s=t.asset.category)==null?void 0:s.name)||"—"}),e.jsx("td",{className:"border p-3 text-sm",children:t.details||"—"}),e.jsx("td",{className:"border p-3 text-center font-bold text-lg",children:t.current_qty}),e.jsx("td",{className:"border p-3 text-sm",children:new Date(t.added_date).toLocaleDateString()}),e.jsx("td",{className:"border p-3 text-sm",children:t.room?`${t.room.name}${t.room.block?` (${t.room.block.name})`:""}`:"—"}),e.jsx("td",{className:"border p-3",children:e.jsxs("div",{className:"flex gap-1",children:[(a==null?void 0:a.can_edit)&&e.jsx(v,{href:`/institute-assets/${t.id}/edit`,children:e.jsx(n,{variant:"ghost",size:"icon",children:e.jsx(E,{className:"h-4 w-4"})})}),(a==null?void 0:a.can_delete)&&e.jsxs(M,{children:[e.jsx(P,{asChild:!0,children:e.jsx(n,{variant:"ghost",size:"icon",className:"text-destructive",children:e.jsx(F,{className:"h-4 w-4"})})}),e.jsxs(K,{children:[e.jsxs(Q,{children:[e.jsx(G,{children:"Delete Asset?"}),e.jsxs(J,{children:[e.jsx("strong",{children:t.asset.name})," (Qty: ",t.current_qty,") will be permanently deleted."]})]}),e.jsxs(U,{children:[e.jsx(V,{children:"Cancel"}),e.jsx(W,{className:"bg-destructive",onClick:()=>_(t.id),children:"Delete"})]})]})]})]})})]},t.id)})})]})}),o.links.length>3&&e.jsx("div",{className:"flex justify-center gap-2 flex-wrap pt-6",children:o.links.map((t,s)=>e.jsx(n,{disabled:!t.url,variant:t.active?"default":"outline",size:"sm",onClick:()=>t.url&&x.visit(t.url,{preserveScroll:!0}),children:e.jsx("span",{dangerouslySetInnerHTML:{__html:t.label}})},s))})]})]})})]})}export{ie as default};
